import{h as e,s as t,v as o,c as r,a as n,b as s,d as i,r as a,e as l,f as c}from"./index-8boum2j8.js";import"./main-DpBCZjI7.js";function d(d){(d.forEach?d:[d]).forEach(d=>{const f=d.dataset.webhook||"https://hook.us2.make.com/x3fm8t3nor5poc4ij7purslvicjo9sxr",h=Array.from(d.querySelectorAll('[data-form="step"]')),m=d.querySelector('[data-helpline-form="ticket-id-field"]'),u=d.querySelector(".w-form-done"),p=d.querySelector(".w-form-fail"),y=d.querySelector("form");m&&(m.disabled=!0,m.type="hidden"),h.forEach((e,t)=>{0!==t&&e.classList.add("hide")}),d.addEventListener("click",d=>{const b=d.target,x=b.closest('[data-form="next-btn"]'),S=b.closest('[data-form="submit-btn"]'),E=b.closest(".button_text");if(x||E&&x){e(p);const l=x.closest('[data-form="step"]');if(!l)return;const c=Array.from(y?.children||[]).indexOf(l);if(-1===c)return;const d=t(l),u=[];if(0===c)o.isEmpty(d["HelpLine-Name"]||"")&&u.push("Enter your full name."),o.isEmail(d["HelpLine-Email"]||"")||u.push("Enter a valid email address (example: name@email.com)"),o.isMobilePhone(d["HelpLine-Phone"]||"")||u.push("Enter a valid phone number (digits only, include area code)");if(r(l),u.length>0)return void n(l,u);const b=x.querySelector(".button_text")||x.firstChild,S=b?.textContent||"Next";s(x),fetch(f,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(d)}).then(e=>{if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);return e.json()}).then(e=>{m&&(m.value=e?.ticket||e||""),l.classList.add("hide");const t=c+1;t<h.length&&h[t].classList.remove("hide")}).catch(e=>{i(p)}).finally(()=>{a(x,S)})}if(S||E&&S){d.preventDefault(),d.stopImmediatePropagation(),e(p);const o=S.closest('[data-form="step"]');if(!o)return;if(-1===Array.from(y?.children||[]).indexOf(o))return;const h=t(o),b=[];if(r(o),b.length>0)return void n(o,b);const x=S.querySelector(".button_text")||S.firstChild,E=x?.textContent||"Submit";s(S),h["ticket-id"]=m.value,fetch(f,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(h)}).then(e=>{if(!e.ok)throw new Error("Submission failed");return e.json()}).then(e=>{l(y),c(u)}).catch(e=>{i(p)}).finally(()=>{a(S,E)})}})})}export{d as default};
//# sourceMappingURL=helpline-CQJ3p9on.js.map
