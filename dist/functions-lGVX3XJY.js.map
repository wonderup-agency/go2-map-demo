{"version":3,"file":"functions-lGVX3XJY.js","sources":["../src/utils/functions.js"],"sourcesContent":["/**\n * Serialize inputs under a root element into an object suitable for POSTing.\n * Handles types: checkbox, radio, text, textarea, date, email, hidden, number, range, tel, select\n *\n * Usage:\n *   import { serializeInputs } from './utils/functions.js'\n *   const payload = serializeInputs(document.getElementById('root'))\n *\n * @param {HTMLElement} root\n * @returns {Object}\n */\nexport function serializeInputs(root) {\n  if (!root || typeof root.querySelectorAll !== 'function') {\n    throw new TypeError('serializeInputs expects a DOM element as the root')\n  }\n\n  // include select and textarea elements in the query\n  const inputs = Array.from(root.querySelectorAll('input, select, textarea'))\n  const groups = inputs.reduce((acc, input) => {\n    const name = input.name\n    if (!name)\n      return acc // skip inputs without a name\n    ;(acc[name] || (acc[name] = [])).push(input)\n    return acc\n  }, {})\n\n  const safeNumber = (v) => {\n    if (v === '') return null\n    const n = Number(v)\n    return Number.isFinite(n) ? n : v\n  }\n\n  const result = {}\n\n  for (const name in groups) {\n    const nodes = groups[name]\n    const first = nodes[0]\n    const tag = (first.tagName || '').toLowerCase()\n    const type = (first.type || '').toLowerCase()\n\n    // handle select elements\n    if (tag === 'select') {\n      if (nodes.length === 1) {\n        const s = nodes[0]\n        if (s.multiple) {\n          result[name] = Array.from(s.selectedOptions).map((o) => o.value)\n        } else {\n          result[name] = s.value\n        }\n      } else {\n        // multiple select elements sharing the same name -> array of values/arrays\n        result[name] = nodes.map((n) => {\n          if ((n.tagName || '').toLowerCase() === 'select') {\n            return n.multiple ? Array.from(n.selectedOptions).map((o) => o.value) : n.value\n          }\n          return n.value\n        })\n      }\n      continue\n    }\n\n    if (type === 'checkbox') {\n      if (nodes.length > 1) {\n        // multiple checkboxes with same name -> array of checked values\n        result[name] = nodes.filter((n) => n.checked).map((n) => n.value)\n      } else {\n        // single checkbox -> boolean if no explicit value, otherwise value or null when unchecked\n        const n = nodes[0]\n        const hasExplicitValue = n.hasAttribute('value')\n        if (!hasExplicitValue) {\n          result[name] = !!n.checked\n        } else {\n          result[name] = n.checked ? n.value : null\n        }\n      }\n      continue\n    }\n\n    if (type === 'radio') {\n      const checked = nodes.find((n) => n.checked)\n      result[name] = checked ? checked.value : null\n      continue\n    }\n\n    if (type === 'number' || type === 'range') {\n      if (nodes.length === 1) {\n        result[name] = safeNumber(nodes[0].value)\n      } else {\n        result[name] = nodes.map((n) => safeNumber(n.value))\n      }\n      continue\n    }\n\n    // text, textarea, date, email, hidden, tel and any other fallback types\n    if (nodes.length === 1) {\n      result[name] = nodes[0].value\n    } else {\n      result[name] = nodes.map((n) => n.value)\n    }\n  }\n\n  return result\n}\n\n/**\n * Watch a <select> element and insert/remove an \"other\" text field when a specific option is selected.\n *\n * @param {Object} options\n * @param {string} options.selectId - ID of the <select> element to watch.\n * @param {string|number} options.otherValue - Option value that should trigger the \"other\" field.\n * @param {string} options.fieldName - name/id for the generated input.\n * @param {string} options.labelName - label text for the generated input.\n * @param {string} options.placeholder - placeholder text for the generated input.\n */\nexport function setupOtherFieldForSelect({ selectId, otherValue, fieldName, labelName, placeholder }) {\n  const select = document.getElementById(selectId)\n  if (!select) {\n    console.error(`Select element with ID \"${selectId}\" not found.`)\n    return\n  }\n\n  const handler = () => {\n    const value = select.value\n    const existing = document.getElementById(fieldName)\n\n    if (value === otherValue.toString()) {\n      if (!existing) {\n        const newField = createTextField(fieldName, labelName, placeholder)\n        const wrapper = select.closest('.multi-form14_field-wrapper')\n        if (wrapper) {\n          wrapper.after(newField)\n        } else {\n          console.error(`Wrapper \".multi-form14_field-wrapper\" not found for select \"${selectId}\".`)\n        }\n      }\n    } else {\n      if (existing) {\n        const otherWrapper = existing.closest('.multi-form14_field-wrapper')\n        if (otherWrapper) {\n          otherWrapper.remove()\n        }\n      }\n    }\n  }\n\n  select.addEventListener('change', handler)\n  handler() // Run initially to handle pre-selected value\n}\n\n/**\n * Watch a checkbox (by name and value) and insert/remove an \"other\" text field when checked.\n *\n * @param {Object} options\n * @param {string} options.checkboxGroup - name attribute of the checkbox group to query.\n * @param {string|number} options.otherValue - checkbox value that should trigger the \"other\" field.\n * @param {string} options.fieldName - name/id for the generated input.\n * @param {string} options.labelName - label text for the generated input.\n * @param {string} options.placeholder - placeholder text for the generated input.\n */\nexport function setupOtherFieldForCheckbox({ checkboxGroup, otherValue, fieldName, labelName, placeholder }) {\n  const checkbox = document.querySelector(`input[name=\"${checkboxGroup}\"][value=\"${otherValue}\"]`)\n  if (!checkbox) {\n    console.error(`Checkbox with name \"${checkboxGroup}\" and value \"${otherValue}\" not found.`)\n    return\n  }\n\n  const handler = () => {\n    const existing = document.getElementById(fieldName)\n\n    if (checkbox.checked) {\n      if (!existing) {\n        const newField = createTextField(fieldName, labelName, placeholder)\n        const specificWrapper = checkbox.closest('.multi-step_checkbox-wrapper')\n        if (specificWrapper) {\n          specificWrapper.after(newField)\n        } else {\n          console.error(`Wrapper \".multi-step_checkbox-wrapper\" not found for checkbox with value \"${otherValue}\".`)\n        }\n      }\n    } else {\n      if (existing) {\n        const otherWrapper = existing.closest('.multi-form14_field-wrapper')\n        if (otherWrapper) {\n          otherWrapper.remove()\n        }\n      }\n    }\n  }\n\n  checkbox.addEventListener('change', handler)\n  handler() // Run initially to handle pre-checked state\n}\n\n/**\n * Create a DOM wrapper containing a label and text input used for \"other\" fields.\n *\n * @private\n * @param {string} fieldName - id and name for the generated input.\n * @param {string} labelName - text content for the label.\n * @param {string} placeholder - placeholder text for the input.\n * @returns {HTMLElement} wrapper element containing the label and input.\n */\nfunction createTextField(fieldName, labelName, placeholder) {\n  const div = document.createElement('div')\n  div.className = 'multi-form14_field-wrapper'\n\n  const label = document.createElement('label')\n  label.htmlFor = fieldName\n  label.className = 'form_field-label'\n  label.textContent = labelName\n\n  const input = document.createElement('input')\n  input.className = 'form_input2 w-input'\n  input.maxLength = 256\n  input.name = fieldName\n  input.dataset.name = fieldName\n  input.placeholder = placeholder\n  input.type = 'text'\n  input.id = fieldName\n  input.required = true\n\n  div.appendChild(label)\n  div.appendChild(input)\n\n  return div\n}\n\n/**\n * Remove any validation error container inside the provided step element.\n *\n * @param {HTMLElement} currentStepEl - Root element of the current step where errors may be shown.\n * @returns {void}\n */\nexport function clearStepsErrors(currentStepEl) {\n  const errorContainer = currentStepEl.querySelector('.validation-errors')\n  if (errorContainer) {\n    errorContainer.remove()\n  }\n}\n\n/**\n * Append validation error messages to the provided step element.\n * Any existing error container is removed before appending the new one.\n *\n * @param {HTMLElement} currentStepEl - Root element of the current step where errors should be appended.\n * @param {string[]} errors - Array of error message strings to display. If empty, no container is created.\n * @returns {void}\n */\nexport function appendStepsErrors(currentStepEl, errors) {\n  // Remove any previous error container to avoid duplicates\n  const prev = currentStepEl.querySelector('.validation-errors')\n  if (prev) prev.remove()\n\n  if (errors.length > 0) {\n    const errDiv = document.createElement('div')\n    errDiv.className = 'validation-errors'\n    errDiv.style.color = 'red'\n    errDiv.style.marginTop = '1rem'\n\n    errors.forEach((msg) => {\n      const line = document.createElement('div')\n      line.textContent = msg\n      errDiv.appendChild(line)\n    })\n\n    currentStepEl.appendChild(errDiv)\n  }\n}\n\n/**\n * Disable a button element and replace its visible text with a loading message.\n * The function sets the button as disabled and adds a 'disabled' CSS class.\n *\n * @param {HTMLElement} btn - The button element to modify.\n * @param {string} [loadingText='Please wait...'] - Text to display while loading.\n * @returns {void}\n */\nexport function setButtonLoading(btn, loadingText = 'Please wait...') {\n  if (!btn) return\n  btn.disabled = true\n  btn.classList.add('disabled')\n  const textEl = btn.querySelector('.button_text') || btn.firstChild\n  if (textEl && textEl.textContent) {\n    textEl.textContent = loadingText\n  }\n}\n\n/**\n * Restore a button's enabled state and reset its visible text.\n * Removes the 'disabled' CSS class and ensures the button is enabled.\n *\n * @param {HTMLElement} btn - The button element to restore.\n * @param {string} originalText - Text to restore on the button.\n * @returns {void}\n */\nexport function resetButton(btn, originalText) {\n  if (!btn) return\n  btn.disabled = false\n  btn.classList.remove('disabled')\n  const textEl = btn.querySelector('.button_text') || btn.firstChild\n  if (textEl && textEl.textContent) {\n    textEl.textContent = originalText\n  }\n}\n\n/**\n * Hide and mark a \"failure\" UI element as hidden for accessibility.\n *\n * @param {HTMLElement|null} failEl - Element that displays failure messages.\n * @returns {void}\n */\nexport function hideFail(failEl) {\n  if (failEl) {\n    failEl.style.display = 'none'\n    failEl.setAttribute('aria-hidden', 'true')\n  }\n}\n\n/**\n * Show a \"failure\" UI element, set accessibility attributes, and focus it.\n *\n * @param {HTMLElement|null} failEl - Element that displays failure messages.\n * @returns {void}\n */\nexport function showFail(failEl) {\n  if (failEl) {\n    failEl.style.display = 'block'\n    failEl.setAttribute('aria-hidden', 'false')\n    failEl.setAttribute('tabindex', '-1')\n    setTimeout(() => failEl.focus(), 50)\n  }\n}\n\n/**\n * Show a \"success\" UI element, set accessibility attributes, and focus it.\n *\n * @param {HTMLElement|null} successEl - Element that displays success messages.\n * @returns {void}\n */\nexport function showSuccess(successEl) {\n  if (successEl) {\n    successEl.style.display = 'block'\n    successEl.setAttribute('aria-hidden', 'false')\n    successEl.setAttribute('tabindex', '-1')\n    setTimeout(() => successEl.focus(), 50)\n  }\n}\n\n/**\n * Hide the provided form element visually and update accessibility attributes.\n *\n * @param {HTMLElement|null} formEl - The form element to hide.\n * @returns {void}\n */\nexport function hideForm(formEl) {\n  if (formEl) {\n    formEl.classList.add('hide')\n    formEl.setAttribute('aria-hidden', 'true')\n  }\n}\n"],"names":["serializeInputs","root","querySelectorAll","TypeError","groups","Array","from","reduce","acc","input","name","push","safeNumber","v","n","Number","isFinite","result","nodes","first","tag","tagName","toLowerCase","type","checked","find","value","length","map","filter","hasExplicitValue","hasAttribute","s","multiple","selectedOptions","o","setupOtherFieldForSelect","selectId","otherValue","fieldName","labelName","placeholder","select","document","getElementById","handler","existing","toString","newField","createTextField","wrapper","closest","after","otherWrapper","remove","addEventListener","setupOtherFieldForCheckbox","checkboxGroup","checkbox","querySelector","specificWrapper","div","createElement","className","label","htmlFor","textContent","maxLength","dataset","id","required","appendChild","clearStepsErrors","currentStepEl","errorContainer","appendStepsErrors","errors","prev","errDiv","style","color","marginTop","forEach","msg","line","setButtonLoading","btn","loadingText","disabled","classList","add","textEl","firstChild","resetButton","originalText","hideFail","failEl","display","setAttribute","showFail","setTimeout","focus","showSuccess","successEl","hideForm","formEl"],"mappings":"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"}