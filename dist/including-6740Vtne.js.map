{"version":3,"file":"including-6740Vtne.js","sources":["../src/components/forms/including.js"],"sourcesContent":["import {\n  serializeInputs,\n  clearStepsErrors,\n  appendStepsErrors,\n  setButtonLoading,\n  resetButton,\n  hideFail,\n  showFail,\n  showSuccess,\n  hideForm,\n} from '../../utils/functions'\n\nimport validator from 'validator'\n\n/**\n * Handles form submission for a multi-step form component.\n * @param {HTMLElement} component - The form component containing steps and inputs.\n */\nexport default function (component) {\n  const formInstances = component.forEach ? component : [component]\n\n  formInstances.forEach((formInstance) => {\n    const webhookAddress = formInstance.dataset.webhook || 'https://hook.us2.make.com/vt23go8uc23q8emcv6jc3nqriswhtnyr'\n\n    const successEl = formInstance.querySelector('.w-form-done')\n    const failEl = formInstance.querySelector('.w-form-fail')\n    const formEl = formInstance.querySelector('form')\n\n    formInstance.addEventListener('click', (e) => {\n      const target = e.target\n      const submitBtn = target.closest('[data-form=\"submit-btn\"]')\n      const buttonText = target.closest('.button_text')\n\n      // SUBMIT BUTTON HANDLER\n      if (submitBtn || (buttonText && submitBtn)) {\n        e.preventDefault()\n        e.stopImmediatePropagation()\n\n        // Hide fail element on button press (validations will rerun)\n        hideFail(failEl)\n\n        const submitInputsData = serializeInputs(formEl)\n\n        // Log serialized data for debugging\n        console.log('Submit button - Serialized submit data:', submitInputsData)\n\n        const errors = []\n\n        // Submit step validations\n        if (validator.isEmpty(submitInputsData['Including-GO2-Name'] || '')) {\n          errors.push({\n            fieldName: 'Including-GO2-Name',\n            error: 'Enter your full name.',\n            appendAt: '.multi-form14_field-wrapper',\n          })\n        }\n        if (!validator.isEmail(submitInputsData['Including-GO2-Email'] || '')) {\n          errors.push({\n            fieldName: 'Including-GO2-Email',\n            error: 'Enter a valid email address (example: name@email.com)',\n            appendAt: '.multi-form14_field-wrapper',\n          })\n        }\n        const phone = submitInputsData['Including-GO2-Phone'] || ''\n        if (!validator.isMobilePhone(phone, 'any')) {\n          errors.push({\n            fieldName: 'Including-GO2-Phone',\n            error: 'Enter a valid phone number (digits only, include area code)',\n            appendAt: '.multi-form14_field-wrapper',\n          })\n        }\n\n        // Clear any existing errors\n        clearStepsErrors(formEl)\n\n        // If there are errors, append them and stop\n        if (errors.length > 0) {\n          appendStepsErrors(errors)\n          return\n        }\n\n        // Set loading state\n        const submitBtnTextEl = submitBtn.querySelector('.button_text') || submitBtn.firstChild\n        const submitBtnInitialText = submitBtnTextEl?.textContent || 'Submit'\n        setButtonLoading(submitBtn)\n\n        fetch(webhookAddress, {\n          method: 'POST',\n          headers: { 'Content-Type': 'application/json' },\n          body: JSON.stringify(submitInputsData),\n        })\n          .then((response) => {\n            if (!response.ok) throw new Error('Submission failed')\n            return response.json()\n          })\n          .then((data) => {\n            hideForm(formEl)\n            showSuccess(successEl)\n          })\n          .catch((error) => {\n            console.error('Submit fetch error:', error)\n            showFail(failEl)\n          })\n          .finally(() => {\n            resetButton(submitBtn, submitBtnInitialText)\n          })\n      }\n    })\n  })\n}\n"],"names":["including","component","forEach","formInstance","webhookAddress","dataset","webhook","successEl","querySelector","failEl","formEl","addEventListener","e","target","submitBtn","closest","buttonText","preventDefault","stopImmediatePropagation","hideFail","submitInputsData","serializeInputs","errors","validator","isEmpty","push","fieldName","error","appendAt","isEmail","phone","isMobilePhone","clearStepsErrors","length","appendStepsErrors","submitBtnTextEl","firstChild","submitBtnInitialText","textContent","setButtonLoading","fetch","method","headers","body","JSON","stringify","then","response","ok","Error","json","data","hideForm","showSuccess","catch","showFail","finally","resetButton"],"mappings":"kIAkBe,SAAAA,EAAUC,IACDA,EAAUC,QAAUD,EAAY,CAACA,IAEzCC,QAASC,IACrB,MAAMC,EAAiBD,EAAaE,QAAQC,SAAW,6DAEjDC,EAAYJ,EAAaK,cAAc,gBACvCC,EAASN,EAAaK,cAAc,gBACpCE,EAASP,EAAaK,cAAc,QAE1CL,EAAaQ,iBAAiB,QAAUC,IACtC,MAAMC,EAASD,EAAEC,OACXC,EAAYD,EAAOE,QAAQ,4BAC3BC,EAAaH,EAAOE,QAAQ,gBAGlC,GAAID,GAAcE,GAAcF,EAAY,CAC1CF,EAAEK,iBACFL,EAAEM,2BAGFC,EAASV,GAET,MAAMW,EAAmBC,EAAgBX,GAKnCY,EAAS,GAGXC,EAAUC,QAAQJ,EAAiB,uBAAyB,KAC9DE,EAAOG,KAAK,CACVC,UAAW,qBACXC,MAAO,wBACPC,SAAU,gCAGTL,EAAUM,QAAQT,EAAiB,wBAA0B,KAChEE,EAAOG,KAAK,CACVC,UAAW,sBACXC,MAAO,wDACPC,SAAU,gCAGd,MAAME,EAAQV,EAAiB,wBAA0B,GAazD,GAZKG,EAAUQ,cAAcD,EAAO,QAClCR,EAAOG,KAAK,CACVC,UAAW,sBACXC,MAAO,8DACPC,SAAU,gCAKdI,IAGIV,EAAOW,OAAS,EAElB,YADAC,EAAkBZ,GAKpB,MAAMa,EAAkBrB,EAAUN,cAAc,iBAAmBM,EAAUsB,WACvEC,EAAuBF,GAAiBG,aAAe,SAC7DC,EAAiBzB,GAEjB0B,MAAMpC,EAAgB,CACpBqC,OAAQ,OACRC,QAAS,CAAE,eAAgB,oBAC3BC,KAAMC,KAAKC,UAAUzB,KAEpB0B,KAAMC,IACL,IAAKA,EAASC,GAAI,MAAM,IAAIC,MAAM,qBAClC,OAAOF,EAASG,SAEjBJ,KAAMK,IACLC,EAAS1C,GACT2C,EAAY9C,KAEb+C,MAAO3B,IAEN4B,EAAS9C,KAEV+C,QAAQ,KACPC,EAAY3C,EAAWuB,IAE7B,KAGN"}