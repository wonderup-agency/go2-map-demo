{"version":3,"file":"functions-CHZiqRQA.js","sources":["../src/utils/functions.js"],"sourcesContent":["/**\n * Serialize inputs under a root element into an object suitable for POSTing.\n * Handles types: checkbox, radio, text, textarea, date, email, hidden, number, range, tel, select\n *\n * Usage:\n *   import { serializeInputs } from './utils/functions.js'\n *   const payload = serializeInputs(document.getElementById('root'))\n *\n * @param {HTMLElement} root\n * @returns {Object}\n */\nexport function serializeInputs(root) {\n  if (!root || typeof root.querySelectorAll !== 'function') {\n    throw new TypeError('serializeInputs expects a DOM element as the root')\n  }\n\n  // include select and textarea elements in the query\n  const inputs = Array.from(root.querySelectorAll('input, select, textarea'))\n  const groups = inputs.reduce((acc, input) => {\n    const name = input.name\n    if (!name)\n      return acc // skip inputs without a name\n    ;(acc[name] || (acc[name] = [])).push(input)\n    return acc\n  }, {})\n\n  const safeNumber = (v) => {\n    if (v === '') return null\n    const n = Number(v)\n    return Number.isFinite(n) ? n : v\n  }\n\n  const result = {}\n\n  for (const name in groups) {\n    const nodes = groups[name]\n    const first = nodes[0]\n    const tag = (first.tagName || '').toLowerCase()\n    const type = (first.type || '').toLowerCase()\n\n    // handle select elements\n    if (tag === 'select') {\n      if (nodes.length === 1) {\n        const s = nodes[0]\n        if (s.multiple) {\n          result[name] = Array.from(s.selectedOptions).map((o) => o.value)\n        } else {\n          result[name] = s.value\n        }\n      } else {\n        // multiple select elements sharing the same name -> array of values/arrays\n        result[name] = nodes.map((n) => {\n          if ((n.tagName || '').toLowerCase() === 'select') {\n            return n.multiple\n              ? Array.from(n.selectedOptions).map((o) => o.value)\n              : n.value\n          }\n          return n.value\n        })\n      }\n      continue\n    }\n\n    if (type === 'checkbox') {\n      if (nodes.length > 1) {\n        // multiple checkboxes with same name -> array of checked values\n        result[name] = nodes.filter((n) => n.checked).map((n) => n.value)\n      } else {\n        // single checkbox -> boolean if no explicit value, otherwise value or null when unchecked\n        const n = nodes[0]\n        const hasExplicitValue = n.hasAttribute('value')\n        if (!hasExplicitValue) {\n          result[name] = !!n.checked\n        } else {\n          result[name] = n.checked ? n.value : null\n        }\n      }\n      continue\n    }\n\n    if (type === 'radio') {\n      const checked = nodes.find((n) => n.checked)\n      result[name] = checked ? checked.value : null\n      continue\n    }\n\n    if (type === 'number' || type === 'range') {\n      if (nodes.length === 1) {\n        result[name] = safeNumber(nodes[0].value)\n      } else {\n        result[name] = nodes.map((n) => safeNumber(n.value))\n      }\n      continue\n    }\n\n    // text, textarea, date, email, hidden, tel and any other fallback types\n    if (nodes.length === 1) {\n      result[name] = nodes[0].value\n    } else {\n      result[name] = nodes.map((n) => n.value)\n    }\n  }\n\n  return result\n}\n\n/**\n * Watch a <select> element and insert/remove an \"other\" text field when a specific option is selected.\n *\n * @param {Object} options\n * @param {string} options.selectId - ID of the <select> element to watch.\n * @param {string|number} options.otherValue - Option value that should trigger the \"other\" field.\n * @param {string} options.fieldName - name/id for the generated input.\n * @param {string} options.labelName - label text for the generated input.\n * @param {string} options.placeholder - placeholder text for the generated input.\n */\nexport function setupOtherFieldForSelect({\n  selectId,\n  otherValue,\n  fieldName,\n  labelName,\n  placeholder,\n}) {\n  const select = document.getElementById(selectId)\n  if (!select) {\n    console.error(`Select element with ID \"${selectId}\" not found.`)\n    return\n  }\n\n  const handler = () => {\n    const value = select.value\n    const existing = document.getElementById(fieldName)\n\n    if (value === otherValue.toString()) {\n      if (!existing) {\n        const newField = createTextField(fieldName, labelName, placeholder)\n        const wrapper = select.closest('.multi-form14_field-wrapper')\n        if (wrapper) {\n          wrapper.after(newField)\n        } else {\n          console.error(\n            `Wrapper \".multi-form14_field-wrapper\" not found for select \"${selectId}\".`\n          )\n        }\n      }\n    } else {\n      if (existing) {\n        const otherWrapper = existing.closest('.multi-form14_field-wrapper')\n        if (otherWrapper) {\n          otherWrapper.remove()\n        }\n      }\n    }\n  }\n\n  select.addEventListener('change', handler)\n  handler() // Run initially to handle pre-selected value\n}\n\n/**\n * Watch a checkbox (by name and value) and insert/remove an \"other\" text field when checked.\n *\n * @param {Object} options\n * @param {string} options.checkboxGroup - name attribute of the checkbox group to query.\n * @param {string|number} options.otherValue - checkbox value that should trigger the \"other\" field.\n * @param {string} options.fieldName - name/id for the generated input.\n * @param {string} options.labelName - label text for the generated input.\n * @param {string} options.placeholder - placeholder text for the generated input.\n */\nexport function setupOtherFieldForCheckbox({\n  checkboxGroup,\n  otherValue,\n  fieldName,\n  labelName,\n  placeholder,\n}) {\n  const checkbox = document.querySelector(\n    `input[name=\"${checkboxGroup}\"][value=\"${otherValue}\"]`\n  )\n  if (!checkbox) {\n    console.error(\n      `Checkbox with name \"${checkboxGroup}\" and value \"${otherValue}\" not found.`\n    )\n    return\n  }\n\n  const handler = () => {\n    const existing = document.getElementById(fieldName)\n\n    if (checkbox.checked) {\n      if (!existing) {\n        const newField = createTextField(fieldName, labelName, placeholder)\n        const specificWrapper = checkbox.closest('.multi-step_checkbox-wrapper')\n        if (specificWrapper) {\n          specificWrapper.after(newField)\n        } else {\n          console.error(\n            `Wrapper \".multi-step_checkbox-wrapper\" not found for checkbox with value \"${otherValue}\".`\n          )\n        }\n      }\n    } else {\n      if (existing) {\n        const otherWrapper = existing.closest('.multi-form14_field-wrapper')\n        if (otherWrapper) {\n          otherWrapper.remove()\n        }\n      }\n    }\n  }\n\n  checkbox.addEventListener('change', handler)\n  handler() // Run initially to handle pre-checked state\n}\n\n/**\n * Create a DOM wrapper containing a label and text input used for \"other\" fields.\n *\n * @private\n * @param {string} fieldName - id and name for the generated input.\n * @param {string} labelName - text content for the label.\n * @param {string} placeholder - placeholder text for the input.\n * @returns {HTMLElement} wrapper element containing the label and input.\n */\nfunction createTextField(fieldName, labelName, placeholder) {\n  const div = document.createElement('div')\n  div.className = 'multi-form14_field-wrapper'\n\n  const label = document.createElement('label')\n  label.htmlFor = fieldName\n  label.className = 'form_field-label'\n  label.textContent = labelName\n\n  const input = document.createElement('input')\n  input.className = 'form_input2 w-input'\n  input.maxLength = 256\n  input.name = fieldName\n  input.dataset.name = fieldName\n  input.placeholder = placeholder\n  input.type = 'text'\n  input.id = fieldName\n  input.required = true\n\n  div.appendChild(label)\n  div.appendChild(input)\n\n  return div\n}\n"],"names":["serializeInputs","root","querySelectorAll","TypeError","groups","Array","from","reduce","acc","input","name","push","safeNumber","v","n","Number","isFinite","result","nodes","first","tag","tagName","toLowerCase","type","checked","find","value","length","map","filter","hasExplicitValue","hasAttribute","s","multiple","selectedOptions","o","setupOtherFieldForSelect","selectId","otherValue","fieldName","labelName","placeholder","select","document","getElementById","handler","existing","toString","newField","createTextField","wrapper","closest","after","otherWrapper","remove","addEventListener","setupOtherFieldForCheckbox","checkboxGroup","checkbox","querySelector","specificWrapper","div","createElement","className","label","htmlFor","textContent","maxLength","dataset","id","required","appendChild"],"mappings":"AAWO,SAASA,EAAgBC,GAC9B,IAAKA,GAAyC,mBAA1BA,EAAKC,iBACvB,MAAM,IAAIC,UAAU,qDAItB,MACMC,EADSC,MAAMC,KAAKL,EAAKC,iBAAiB,4BAC1BK,OAAO,CAACC,EAAKC,KACjC,MAAMC,EAAOD,EAAMC,KACnB,OAAKA,IAEHF,EAAIE,KAAUF,EAAIE,GAAQ,KAAKC,KAAKF,GAC/BD,GAFEA,GAGR,CAAA,GAEGI,EAAcC,IAClB,GAAU,KAANA,EAAU,OAAO,KACrB,MAAMC,EAAIC,OAAOF,GACjB,OAAOE,OAAOC,SAASF,GAAKA,EAAID,GAG5BI,EAAS,CAAA,EAEf,IAAK,MAAMP,KAAQN,EAAQ,CACzB,MAAMc,EAAQd,EAAOM,GACfS,EAAQD,EAAM,GACdE,GAAOD,EAAME,SAAW,IAAIC,cAC5BC,GAAQJ,EAAMI,MAAQ,IAAID,cAGhC,GAAY,WAARF,EAsBJ,GAAa,aAATG,EAAJ,CAiBA,GAAa,UAATA,EAAkB,CACpB,MAAMC,EAAUN,EAAMO,KAAMX,GAAMA,EAAEU,SACpCP,EAAOP,GAAQc,EAAUA,EAAQE,MAAQ,KACzC,QACF,CAEa,WAATH,GAA8B,UAATA,EAUJ,IAAjBL,EAAMS,OACRV,EAAOP,GAAQQ,EAAM,GAAGQ,MAExBT,EAAOP,GAAQQ,EAAMU,IAAKd,GAAMA,EAAEY,OAZb,IAAjBR,EAAMS,OACRV,EAAOP,GAAQE,EAAWM,EAAM,GAAGQ,OAEnCT,EAAOP,GAAQQ,EAAMU,IAAKd,GAAMF,EAAWE,EAAEY,OAZjD,MAdE,GAAIR,EAAMS,OAAS,EAEjBV,EAAOP,GAAQQ,EAAMW,OAAQf,GAAMA,EAAEU,SAASI,IAAKd,GAAMA,EAAEY,WACtD,CAEL,MAAMZ,EAAII,EAAM,GACVY,EAAmBhB,EAAEiB,aAAa,SAItCd,EAAOP,GAHJoB,EAGYhB,EAAEU,QAAUV,EAAEY,MAAQ,OAFpBZ,EAAEU,OAIvB,MAlCA,GAAqB,IAAjBN,EAAMS,OAAc,CACtB,MAAMK,EAAId,EAAM,GACZc,EAAEC,SACJhB,EAAOP,GAAQL,MAAMC,KAAK0B,EAAEE,iBAAiBN,IAAKO,GAAMA,EAAET,OAE1DT,EAAOP,GAAQsB,EAAEN,KAErB,MAEET,EAAOP,GAAQQ,EAAMU,IAAKd,GACgB,YAAnCA,EAAEO,SAAW,IAAIC,eACbR,EAAEmB,SACL5B,MAAMC,KAAKQ,EAAEoB,iBAAiBN,IAAKO,GAAMA,EAAET,OAG1CZ,EAAEY,MA4CjB,CAEA,OAAOT,CACT,CAYO,SAASmB,GAAyBC,SACvCA,EAAQC,WACRA,EAAUC,UACVA,EAASC,UACTA,EAASC,YACTA,IAEA,MAAMC,EAASC,SAASC,eAAeP,GACvC,IAAKK,EAEH,OAGF,MAAMG,EAAU,KACd,MAAMnB,EAAQgB,EAAOhB,MACfoB,EAAWH,SAASC,eAAeL,GAEzC,GAAIb,IAAUY,EAAWS,YACvB,IAAKD,EAAU,CACb,MAAME,EAAWC,EAAgBV,EAAWC,EAAWC,GACjDS,EAAUR,EAAOS,QAAQ,+BAC3BD,GACFA,EAAQE,MAAMJ,EAMlB,OAEA,GAAIF,EAAU,CACZ,MAAMO,EAAeP,EAASK,QAAQ,+BAClCE,GACFA,EAAaC,QAEjB,GAIJZ,EAAOa,iBAAiB,SAAUV,GAClCA,GACF,CAYO,SAASW,GAA2BC,cACzCA,EAAanB,WACbA,EAAUC,UACVA,EAASC,UACTA,EAASC,YACTA,IAEA,MAAMiB,EAAWf,SAASgB,cACxB,eAAeF,cAA0BnB,OAE3C,IAAKoB,EAIH,OAGF,MAAMb,EAAU,KACd,MAAMC,EAAWH,SAASC,eAAeL,GAEzC,GAAImB,EAASlC,SACX,IAAKsB,EAAU,CACb,MAAME,EAAWC,EAAgBV,EAAWC,EAAWC,GACjDmB,EAAkBF,EAASP,QAAQ,gCACrCS,GACFA,EAAgBR,MAAMJ,EAM1B,OAEA,GAAIF,EAAU,CACZ,MAAMO,EAAeP,EAASK,QAAQ,+BAClCE,GACFA,EAAaC,QAEjB,GAIJI,EAASH,iBAAiB,SAAUV,GACpCA,GACF,CAWA,SAASI,EAAgBV,EAAWC,EAAWC,GAC7C,MAAMoB,EAAMlB,SAASmB,cAAc,OACnCD,EAAIE,UAAY,6BAEhB,MAAMC,EAAQrB,SAASmB,cAAc,SACrCE,EAAMC,QAAU1B,EAChByB,EAAMD,UAAY,mBAClBC,EAAME,YAAc1B,EAEpB,MAAM/B,EAAQkC,SAASmB,cAAc,SAarC,OAZArD,EAAMsD,UAAY,sBAClBtD,EAAM0D,UAAY,IAClB1D,EAAMC,KAAO6B,EACb9B,EAAM2D,QAAQ1D,KAAO6B,EACrB9B,EAAMgC,YAAcA,EACpBhC,EAAMc,KAAO,OACbd,EAAM4D,GAAK9B,EACX9B,EAAM6D,UAAW,EAEjBT,EAAIU,YAAYP,GAChBH,EAAIU,YAAY9D,GAEToD,CACT"}