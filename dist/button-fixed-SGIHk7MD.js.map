{"version":3,"file":"button-fixed-SGIHk7MD.js","sources":["../src/components/button-fixed.js"],"sourcesContent":["// path: /components/button-fixed.js\n/**\n * @param {HTMLElement} component\n */\nexport default async function (component) {\n  // Motion config\n  const prefersReduced = window.matchMedia('(prefers-reduced-motion: reduce)').matches\n  const DUR = prefersReduced ? 1 : 800\n  const STEP = prefersReduced ? 0 : 200\n  const CLOSE_DUR = prefersReduced ? 1 : 260\n  const EASE = 'cubic-bezier(.22,1,.36,1)'\n  const FAST_COLLAPSE = true\n  const getDisplay = (el) => el?.dataset?.display || 'flex'\n\n  // Cookie helpers (why: control de visibilidad cross-page)\n  const SUPPORT_COOKIE = 'bf_support_hidden'\n  const setCookie = (name, value, days) => {\n    const d = new Date()\n    d.setTime(d.getTime() + days * 24 * 60 * 60 * 1000)\n    document.cookie = `${name}=${encodeURIComponent(value)};expires=${d.toUTCString()};path=/;SameSite=Lax`\n  }\n  const getCookie = (name) => {\n    const m = document.cookie.match(new RegExp('(?:^|; )' + name.replace(/([.$?*|{}()[\\]\\\\/+^])/g, '\\\\$1') + '=([^;]*)'))\n    return m ? decodeURIComponent(m[1]) : null\n  }\n  const isSupportSuppressed = () => getCookie(SUPPORT_COOKIE) === '1'\n\n  // Refs\n  const mainButton = component.querySelector('.button_fixed')\n  const items = Array.from(component.querySelectorAll('[data-button-fixed=\"item\"]'))\n  const switches = Array.from(component.querySelectorAll('.button_switch'))\n  const [switchClosedEl, switchOpenEl] = [switches[0], switches[1] || switches[0]] // enforce order\n\n  const selCloseMail = '[data-close-mail]'\n  const selClosePhone = '[data-close-phone]'\n  const selCloseSupport = '[data-close-support-now]'\n\n  const supportItem = items.find((i) => i.hasAttribute('data-button-support')) || null\n\n  // Block anchors \"#\"\n  component.querySelectorAll('a[href=\"#\"]').forEach((a) =>\n    a.addEventListener('click', (e) => {\n      e.preventDefault()\n      e.stopPropagation()\n    })\n  )\n\n  // Init\n  items.forEach((el) => {\n    el.style.display = 'none'\n    el.style.opacity = 0\n  })\n  switches.forEach((s) => s.classList.remove('is-active'))\n  switchClosedEl?.classList.add('is-active')\n  mainButton?.setAttribute('aria-expanded', 'false')\n\n  // Si cookie ya existe, marca el support para saltarlo (why: no re-aparecer)\n  if (supportItem && isSupportSuppressed()) {\n    supportItem.dataset.skip = 'true'\n  }\n\n  let opened = false\n  const isVisible = (el) => getComputedStyle(el).display !== 'none'\n  const anyVisible = () => items.some(isVisible)\n\n  const setSwitchState = (isOpen) => {\n    if (isOpen) {\n      switchClosedEl?.classList.remove('is-active')\n      switchOpenEl?.classList.add('is-active')\n      mainButton?.setAttribute('aria-expanded', 'true')\n    } else {\n      switchOpenEl?.classList.remove('is-active')\n      switchClosedEl?.classList.add('is-active')\n      mainButton?.setAttribute('aria-expanded', 'false')\n    }\n  }\n\n  const openAll = () => {\n    if (opened) return\n    opened = true\n    setSwitchState(true)\n    const bottomToTop = [...items].reverse()\n    // Filtra soporte si cookie está activa o marcado como skip\n    const toShow = bottomToTop.filter((el) => !(el === supportItem && (isSupportSuppressed() || el.dataset.skip === 'true')))\n    toShow.forEach((el, i) => {\n      el.style.display = getDisplay(el)\n      el.animate([{ opacity: 0 }, { opacity: 1 }], {\n        duration: DUR,\n        delay: i * STEP,\n        easing: EASE,\n        fill: 'forwards',\n      })\n    })\n  }\n\n  const collapseItem = (el) => {\n    if (!el || !isVisible(el)) return\n    if (FAST_COLLAPSE) {\n      // Why: evita reflow costoso\n      el.style.willChange = 'transform,opacity'\n      const anim = el.animate(\n        [\n          { opacity: 1, transform: 'translateY(0)' },\n          { opacity: 0, transform: 'translateY(8px)' },\n        ],\n        { duration: CLOSE_DUR, easing: EASE, fill: 'forwards' }\n      )\n      anim.onfinish = () => {\n        el.style.display = 'none'\n        el.style.opacity = ''\n        el.style.transform = ''\n        el.style.willChange = ''\n        if (!anyVisible()) {\n          opened = false\n          setSwitchState(false)\n        }\n      }\n      return\n    }\n    const h = el.offsetHeight || el.scrollHeight || 0\n    el.style.willChange = 'height,opacity'\n    el.style.height = `${h}px`\n    el.style.overflow = 'hidden'\n    el.style.opacity = 1\n    requestAnimationFrame(() => {\n      const anim = el.animate(\n        [\n          { height: `${h}px`, opacity: 1 },\n          { height: '0px', opacity: 0 },\n        ],\n        { duration: CLOSE_DUR, easing: EASE, fill: 'forwards' }\n      )\n      anim.onfinish = () => {\n        el.style.display = 'none'\n        el.style.height = ''\n        el.style.overflow = ''\n        el.style.opacity = ''\n        el.style.willChange = ''\n        if (!anyVisible()) {\n          opened = false\n          setSwitchState(false)\n        }\n      }\n    })\n  }\n\n  const closeAll = () => {\n    if (!anyVisible()) {\n      opened = false\n      setSwitchState(false)\n      return\n    }\n    opened = false\n    setSwitchState(false)\n    items.forEach((el) => isVisible(el) && collapseItem(el))\n  }\n\n  // Events\n  mainButton?.addEventListener(\n    'click',\n    (ev) => {\n      if (ev.target.closest('[data-button-fixed=\"item\"]')) return\n      opened ? closeAll() : openAll()\n    },\n    true\n  )\n\n  component.addEventListener('click', (e) => {\n    const t = e.target\n    if (t.closest(selCloseMail)) {\n      e.preventDefault()\n      collapseItem(items.find((i) => i.hasAttribute('data-button-mail')))\n      return\n    }\n    if (t.closest(selClosePhone)) {\n      e.preventDefault()\n      collapseItem(items.find((i) => i.hasAttribute('data-button-phone')))\n      return\n    }\n    if (t.closest(selCloseSupport)) {\n      e.preventDefault()\n      // Marca cookie 7 días y suprime futuras aperturas\n      setCookie(SUPPORT_COOKIE, '1', 7)\n      if (supportItem) supportItem.dataset.skip = 'true'\n      collapseItem(supportItem)\n      return\n    }\n  })\n\n  const onDocClick = (e) => {\n    if (e.target.closest('[data-component=\"button-fixed\"]')) return\n    closeAll()\n  }\n  document.addEventListener('click', onDocClick)\n\n  const onKey = (e) => {\n    if (e.key === 'Escape') closeAll()\n  }\n  document.addEventListener('keydown', onKey)\n\n  // Why: prevenir fugas en SPA cuando el nodo se remueve\n  component.addEventListener('DOMNodeRemoved', (e) => {\n    if (e.target === component) {\n      document.removeEventListener('click', onDocClick)\n      document.removeEventListener('keydown', onKey)\n    }\n  })\n\n  component.__buttonFixedDebug = {\n    openAll,\n    closeAll,\n    collapseItem,\n    _cookie: { get: getCookie, set: setCookie, key: SUPPORT_COOKIE }\n  }\n}\n"],"names":[],"mappings":"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"}