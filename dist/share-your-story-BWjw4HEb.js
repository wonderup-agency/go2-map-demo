import{g as e,j as t,h as n,s as a,v as o,c as r,a as i,b as c,d as l,e as d,f as s,r as p}from"./index-BoHs7NVw.js";import"./main-CPsq_X1p.js";function m(m){(m.forEach?m:[m]).forEach(m=>{const f=m.dataset.webhook||"https://hook.us2.make.com/8obr35mtbmpo6xdqasiq9ythue5h2s2g",u=m.querySelector(".w-form-done"),h=m.querySelector(".w-form-fail"),y=m.querySelector("form");e({context:m,selectId:"connection-to-lung-cancer",otherValue:"other-connection",fieldName:"other-connection-to-cancer",labelName:"Specify other connection",placeholder:"Specify your connection to lung cancer"}),e({context:m,selectId:"cancer-type",otherValue:"other-type",fieldName:"other-cancer-type",labelName:"Other cancer type",placeholder:"Specify type of cancer"}),t({context:m,selectId:"diagnosed",dependentValue:"is-diagnosed"});const g=document.getElementById("photo-files"),E=document.getElementById("files-list");let b=[];function v(){E.innerHTML="",b.forEach((e,t)=>{const n=document.createElement("div"),a=document.createElement("button");a.textContent="(remove)",a.type="button",a.addEventListener("click",()=>{b.splice(t,1),function(){const e=new DataTransfer;b.forEach(t=>e.items.add(t)),g.files=e.files}(),v()}),n.textContent=`${e.name} `,n.appendChild(a),E.appendChild(n)})}g.addEventListener("click",()=>{E.innerHTML="",b=[]}),g.addEventListener("change",()=>{const e=Array.from(g.files);if(0===e.length)return;E.innerHTML="",b=[];let t=0;e.forEach(n=>{const a=new FileReader;a.addEventListener("load",()=>{t++,b.push(n),t===e.length&&v()}),a.addEventListener("error",()=>{alert(`Error loading ${n.name}`)}),a.readAsDataURL(n)})}),m.addEventListener("click",async e=>{const t=e.target,g=t.closest('[data-form="submit-btn"]'),E=t.closest(".button_text");if(g||E&&g){e.preventDefault(),e.stopImmediatePropagation(),n(h);const t=await a(y),E=[];o.isEmpty(t["full-name"]||"")&&E.push({fieldName:"full-name",error:"Enter your full name.",appendAt:".multi-form14_field-wrapper"}),o.isEmail(t.email||"")||E.push({fieldName:"email",error:"Enter a valid email address (example: name@email.com)",appendAt:".multi-form14_field-wrapper"}),o.isEmpty(t.city||"")&&E.push({fieldName:"city",error:"Enter a valid city name",appendAt:".multi-form14_field-wrapper"}),"other-connection-to-cancer"in t&&o.isEmpty(t["other-connection-to-cancer"]||"")&&E.push({fieldName:"other-connection-to-cancer",error:"Tell us your connection to lung cancer",appendAt:".multi-form14_field-wrapper"}),o.isEmpty(t.experience||"")&&E.push({fieldName:"experience",error:"Please tell us your experience with lung cancer.",appendAt:".multi-form14_field-wrapper"});const b="true"===m.querySelector("#diagnosis-date").closest("[data-depends-on]").getAttribute("data-active"),v=t["diagnosis-date"]??"";if(b&&o.isEmpty(v)&&E.push({fieldName:"diagnosis-date",error:"Enter the diangosis date",appendAt:".multi-form14_field-wrapper"}),r(),E.length>0)return void i(E);"is-diagnosed"!=document.querySelector("#diagnosed").value&&(delete t["cancer-type"],delete t["cancer-stage"],delete t["diagnosis-date"],delete t["other-cancer-type"]),delete t["photo-files-old"];const w=g.querySelector(".button_text")||g.firstChild,x=w?.textContent||"Submit";c(g),fetch(f,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then(e=>{if(!e.ok)throw new Error("Submission failed");return e.json()}).then(e=>{l(y),d(u)}).catch(e=>{s(h)}).finally(()=>{p(g,x)})}})})}export{m as default};
