function e(e){if(!e||"function"!=typeof e.querySelectorAll)throw new TypeError("serializeInputs expects a DOM element as the root");const t=Array.from(e.querySelectorAll("input, select, textarea")).reduce((e,t)=>{const i=t.name;return i?((e[i]||(e[i]=[])).push(t),e):e},{}),i=e=>{if(""===e)return null;const t=Number(e);return Number.isFinite(t)?t:e},a={};for(const e in t){const r=t[e],s=r[0],n=(s.tagName||"").toLowerCase(),l=(s.type||"").toLowerCase();if("select"!==n)if("checkbox"!==l){if("radio"===l){const t=r.find(e=>e.checked);a[e]=t?t.value:null;continue}"number"!==l&&"range"!==l?1===r.length?a[e]=r[0].value:a[e]=r.map(e=>e.value):1===r.length?a[e]=i(r[0].value):a[e]=r.map(e=>i(e.value))}else if(r.length>1)a[e]=r.filter(e=>e.checked).map(e=>e.value);else{const t=r[0],i=t.hasAttribute("value");a[e]=i?t.checked?t.value:null:!!t.checked}else if(1===r.length){const t=r[0];t.multiple?a[e]=Array.from(t.selectedOptions).map(e=>e.value):a[e]=t.value}else a[e]=r.map(e=>"select"===(e.tagName||"").toLowerCase()&&e.multiple?Array.from(e.selectedOptions).map(e=>e.value):e.value)}return a}function t(t){const i=t.dataset.webhook||"https://hook.us2.make.com/x3fm8t3nor5poc4ij7purslvicjo9sxr",a=t.querySelectorAll('[data-form="step"]'),r=t.querySelector('[data-helpline-form="ticket-id-field"]'),s=t.querySelector('[data-form="next-btn"]'),n=s.firstChild.textContent,l=t.querySelector('[data-form="submit-btn"]'),o=l.firstChild.textContent,d=t.querySelector(".w-form-done"),u=t.querySelector(".w-form-fail"),c=t.querySelector("form");r&&(r.disabled=!0,r.type="hidden"),s.addEventListener("click",t=>{if(!t.isTrusted)return;if(t.currentTarget.classList.contains("disabled"))return t.preventDefault(),void t.stopImmediatePropagation();t.preventDefault(),t.stopImmediatePropagation();const l=e(a[0]);s.disabled=!0,s.classList.add("disabled"),s.firstChild.textContent="Please wait...",fetch(i,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)}).then(e=>{if(!e.ok)throw new Error("Submission failed");return e.json()}).then(e=>{r&&(r.value=e||"");const t=new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window});s.dispatchEvent(t)}).catch(e=>{u&&(u.style.display="block",u.setAttribute("aria-hidden","false"),u.setAttribute("tabindex","-1"),setTimeout(()=>u.focus(),50))}).finally(()=>{s.disabled=!1,s.classList.remove("disabled"),s.firstChild.textContent=n})},!0),l.addEventListener("click",t=>{if(t.preventDefault(),t.stopImmediatePropagation(),r?.value){const t=e(a[1]);t["ticket-id"]=r.value,l.disabled=!0,l.classList.add("disabled"),l.firstChild.textContent="Please wait...",fetch(i,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then(e=>{if(!e.ok)throw new Error("Submission failed");return e.json()}).then(e=>{c&&(c.style.display="none",c.setAttribute("aria-hidden","true")),u&&(u.style.display="none",u.setAttribute("aria-hidden","true")),d&&(d.style.display="block",d.setAttribute("aria-hidden","false"),d.setAttribute("tabindex","-1"),setTimeout(()=>d.focus(),50))}).catch(e=>{c&&c.setAttribute("aria-hidden","true"),d&&(d.style.display="none",d.setAttribute("aria-hidden","true")),u&&(u.style.display="block",u.setAttribute("aria-hidden","false"),u.setAttribute("tabindex","-1"),setTimeout(()=>u.focus(),50))}).finally(()=>{l.disabled=!1,l.classList.remove("disabled"),l.firstChild.textContent=o})}else alert("There was an error updating your information...")},!0)}export{t as default};
//# sourceMappingURL=helpline-form-D_JDDg_s.js.map
