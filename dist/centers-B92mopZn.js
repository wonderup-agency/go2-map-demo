const t=t=>{var e,r,n,s="google",o="importLibrary",i="__ib__",a=document,c=window,l=c[s]||(c[s]={}),u=l.maps||(l.maps={}),h=new Set,p=new URLSearchParams;u[o]||(u[o]=(c,...l)=>h.add(c)&&(e||(e=new Promise(async(o,c)=>{for(n in await(r=a.createElement("script")),p.set("libraries",[...h]+""),t)p.set(n.replace(/[A-Z]/g,t=>"_"+t[0].toLowerCase()),t[n]);p.set("callback",s+".maps."+i),function(t,e){t.src=e}(r,"https://maps.googleapis.com/maps/api/js?"+p),u[i]=o,r.onerror=()=>e=c(Error("The Google Maps JavaScript API could not load.")),r.nonce=a.querySelector("script[nonce]")?.nonce||"",a.head.append(r)}))).then(()=>u[o](c,...l)))};let e=!1;function r(r){e?(t=>{JSON.stringify(t)})(r):(!function(e){const r=Boolean(window.google?.maps?.importLibrary);r&&(t=>{JSON.stringify(t)})(e);r||t(e)}(r),e=!0)}const{getOwnPropertyNames:n,getOwnPropertySymbols:s}=Object,{hasOwnProperty:o}=Object.prototype;function i(t,e){return function(r,n,s){return t(r,n,s)&&e(r,n,s)}}function a(t){return function(e,r,n){if(!e||!r||"object"!=typeof e||"object"!=typeof r)return t(e,r,n);const{cache:s}=n,o=s.get(e),i=s.get(r);if(o&&i)return o===r&&i===e;s.set(e,r),s.set(r,e);const a=t(e,r,n);return s.delete(e),s.delete(r),a}}function c(t){return n(t).concat(s(t))}const l=Object.hasOwn||((t,e)=>o.call(t,e));function u(t,e){return t===e||!t&&!e&&t!=t&&e!=e}const{getOwnPropertyDescriptor:h,keys:p}=Object;function d(t,e){return t.byteLength===e.byteLength&&_(new Uint8Array(t),new Uint8Array(e))}function f(t,e,r){let n=t.length;if(e.length!==n)return!1;for(;n-- >0;)if(!r.equals(t[n],e[n],n,n,t,e,r))return!1;return!0}function m(t,e){return t.byteLength===e.byteLength&&_(new Uint8Array(t.buffer,t.byteOffset,t.byteLength),new Uint8Array(e.buffer,e.byteOffset,e.byteLength))}function g(t,e){return u(t.getTime(),e.getTime())}function y(t,e){return t.name===e.name&&t.message===e.message&&t.cause===e.cause&&t.stack===e.stack}function w(t,e){return t===e}function b(t,e,r){const n=t.size;if(n!==e.size)return!1;if(!n)return!0;const s=new Array(n),o=t.entries();let i,a,c=0;for(;(i=o.next())&&!i.done;){const n=e.entries();let o=!1,l=0;for(;(a=n.next())&&!a.done;){if(s[l]){l++;continue}const n=i.value,u=a.value;if(r.equals(n[0],u[0],c,l,t,e,r)&&r.equals(n[1],u[1],n[0],u[0],t,e,r)){o=s[l]=!0;break}l++}if(!o)return!1;c++}return!0}const E=u;function v(t,e,r){const n=p(t);let s=n.length;if(p(e).length!==s)return!1;for(;s-- >0;)if(!L(t,e,r,n[s]))return!1;return!0}function k(t,e,r){const n=c(t);let s,o,i,a=n.length;if(c(e).length!==a)return!1;for(;a-- >0;){if(s=n[a],!L(t,e,r,s))return!1;if(o=h(t,s),i=h(e,s),(o||i)&&(!o||!i||o.configurable!==i.configurable||o.enumerable!==i.enumerable||o.writable!==i.writable))return!1}return!0}function x(t,e){return u(t.valueOf(),e.valueOf())}function M(t,e){return t.source===e.source&&t.flags===e.flags}function A(t,e,r){const n=t.size;if(n!==e.size)return!1;if(!n)return!0;const s=new Array(n),o=t.values();let i,a;for(;(i=o.next())&&!i.done;){const n=e.values();let o=!1,c=0;for(;(a=n.next())&&!a.done;){if(!s[c]&&r.equals(i.value,a.value,i.value,a.value,t,e,r)){o=s[c]=!0;break}c++}if(!o)return!1}return!0}function _(t,e){let r=t.byteLength;if(e.byteLength!==r||t.byteOffset!==e.byteOffset)return!1;for(;r-- >0;)if(t[r]!==e[r])return!1;return!0}function C(t,e){return t.hostname===e.hostname&&t.pathname===e.pathname&&t.protocol===e.protocol&&t.port===e.port&&t.hash===e.hash&&t.username===e.username&&t.password===e.password}function L(t,e,r,n){return!("_owner"!==n&&"__o"!==n&&"__v"!==n||!t.$$typeof&&!e.$$typeof)||l(e,n)&&r.equals(t[n],e[n],n,n,t,e,r)}const T={"[object Int8Array]":!0,"[object Uint8Array]":!0,"[object Uint8ClampedArray]":!0,"[object Int16Array]":!0,"[object Uint16Array]":!0,"[object Int32Array]":!0,"[object Uint32Array]":!0,"[object Float16Array]":!0,"[object Float32Array]":!0,"[object Float64Array]":!0,"[object BigInt64Array]":!0,"[object BigUint64Array]":!0},O=Object.prototype.toString;function j({areArrayBuffersEqual:t,areArraysEqual:e,areDataViewsEqual:r,areDatesEqual:n,areErrorsEqual:s,areFunctionsEqual:o,areMapsEqual:i,areNumbersEqual:a,areObjectsEqual:c,arePrimitiveWrappersEqual:l,areRegExpsEqual:u,areSetsEqual:h,areTypedArraysEqual:p,areUrlsEqual:d,unknownTagComparators:f}){return function(m,g,y){if(m===g)return!0;if(null==m||null==g)return!1;const w=typeof m;if(w!==typeof g)return!1;if("object"!==w)return"number"===w?a(m,g,y):"function"===w&&o(m,g,y);const b=m.constructor;if(b!==g.constructor)return!1;if(b===Object)return c(m,g,y);if(Array.isArray(m))return e(m,g,y);if(b===Date)return n(m,g,y);if(b===RegExp)return u(m,g,y);if(b===Map)return i(m,g,y);if(b===Set)return h(m,g,y);const E=O.call(m);if("[object Date]"===E)return n(m,g,y);if("[object RegExp]"===E)return u(m,g,y);if("[object Map]"===E)return i(m,g,y);if("[object Set]"===E)return h(m,g,y);if("[object Object]"===E)return"function"!=typeof m.then&&"function"!=typeof g.then&&c(m,g,y);if("[object URL]"===E)return d(m,g,y);if("[object Error]"===E)return s(m,g,y);if("[object Arguments]"===E)return c(m,g,y);if(T[E])return p(m,g,y);if("[object ArrayBuffer]"===E)return t(m,g,y);if("[object DataView]"===E)return r(m,g,y);if("[object Boolean]"===E||"[object Number]"===E||"[object String]"===E)return l(m,g,y);if(f){let t=f[E];if(!t){const e=null!=(v=m)?v[Symbol.toStringTag]:void 0;e&&(t=f[e])}if(t)return t(m,g,y)}var v;return!1}}const S=I();function I(t={}){const{circular:e=!1,createInternalComparator:r,createState:n,strict:s=!1}=t,o=function({circular:t,createCustomConfig:e,strict:r}){let n={areArrayBuffersEqual:d,areArraysEqual:r?k:f,areDataViewsEqual:m,areDatesEqual:g,areErrorsEqual:y,areFunctionsEqual:w,areMapsEqual:r?i(b,k):b,areNumbersEqual:E,areObjectsEqual:r?k:v,arePrimitiveWrappersEqual:x,areRegExpsEqual:M,areSetsEqual:r?i(A,k):A,areTypedArraysEqual:r?i(_,k):_,areUrlsEqual:C,unknownTagComparators:void 0};if(e&&(n=Object.assign({},n,e(n))),t){const t=a(n.areArraysEqual),e=a(n.areMapsEqual),r=a(n.areObjectsEqual),s=a(n.areSetsEqual);n=Object.assign({},n,{areArraysEqual:t,areMapsEqual:e,areObjectsEqual:r,areSetsEqual:s})}return n}(t),c=j(o);var l;return function({circular:t,comparator:e,createState:r,equals:n,strict:s}){if(r)return function(o,i){const{cache:a=(t?new WeakMap:void 0),meta:c}=r();return e(o,i,{cache:a,equals:n,meta:c,strict:s})};if(t)return function(t,r){return e(t,r,{cache:new WeakMap,equals:n,meta:void 0,strict:s})};const o={cache:void 0,equals:n,meta:void 0,strict:s};return function(t,r){return e(t,r,o)}}({circular:e,comparator:c,createState:n,equals:r?r(c):(l=c,function(t,e,r,n,s,o,i){return l(t,e,i)}),strict:s})}I({strict:!0}),I({circular:!0}),I({circular:!0,strict:!0}),I({createInternalComparator:()=>u}),I({strict:!0,createInternalComparator:()=>u}),I({circular:!0,createInternalComparator:()=>u}),I({circular:!0,createInternalComparator:()=>u,strict:!0});const q=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class P{static from(t){if(!(t instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[e,r]=new Uint8Array(t,0,2);if(219!==e)throw new Error("Data does not appear to be in a KDBush format.");const n=r>>4;if(1!==n)throw new Error(`Got v${n} data when expected v1.`);const s=q[15&r];if(!s)throw new Error("Unrecognized array type.");const[o]=new Uint16Array(t,2,1),[i]=new Uint32Array(t,4,1);return new P(i,o,s,t)}constructor(t,e=64,r=Float64Array,n){if(isNaN(t)||t<0)throw new Error(`Unpexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+e,2),65535),this.ArrayType=r,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;const s=q.indexOf(this.ArrayType),o=2*t*this.ArrayType.BYTES_PER_ELEMENT,i=t*this.IndexArrayType.BYTES_PER_ELEMENT,a=(8-i%8)%8;if(s<0)throw new Error(`Unexpected typed array class: ${r}.`);n&&n instanceof ArrayBuffer?(this.data=n,this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+i+a,2*t),this._pos=2*t,this._finished=!0):(this.data=new ArrayBuffer(8+o+i+a),this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+i+a,2*t),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+s]),new Uint16Array(this.data,2,1)[0]=e,new Uint32Array(this.data,4,1)[0]=t)}add(t,e){const r=this._pos>>1;return this.ids[r]=r,this.coords[this._pos++]=t,this.coords[this._pos++]=e,r}finish(){const t=this._pos>>1;if(t!==this.numItems)throw new Error(`Added ${t} items when expected ${this.numItems}.`);return U(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(t,e,r,n){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:s,coords:o,nodeSize:i}=this,a=[0,s.length-1,0],c=[];for(;a.length;){const l=a.pop()||0,u=a.pop()||0,h=a.pop()||0;if(u-h<=i){for(let i=h;i<=u;i++){const a=o[2*i],l=o[2*i+1];a>=t&&a<=r&&l>=e&&l<=n&&c.push(s[i])}continue}const p=h+u>>1,d=o[2*p],f=o[2*p+1];d>=t&&d<=r&&f>=e&&f<=n&&c.push(s[p]),(0===l?t<=d:e<=f)&&(a.push(h),a.push(p-1),a.push(1-l)),(0===l?r>=d:n>=f)&&(a.push(p+1),a.push(u),a.push(1-l))}return c}within(t,e,r){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:n,coords:s,nodeSize:o}=this,i=[0,n.length-1,0],a=[],c=r*r;for(;i.length;){const l=i.pop()||0,u=i.pop()||0,h=i.pop()||0;if(u-h<=o){for(let r=h;r<=u;r++)N(s[2*r],s[2*r+1],t,e)<=c&&a.push(n[r]);continue}const p=h+u>>1,d=s[2*p],f=s[2*p+1];N(d,f,t,e)<=c&&a.push(n[p]),(0===l?t-r<=d:e-r<=f)&&(i.push(h),i.push(p-1),i.push(1-l)),(0===l?t+r>=d:e+r>=f)&&(i.push(p+1),i.push(u),i.push(1-l))}return a}}function U(t,e,r,n,s,o){if(s-n<=r)return;const i=n+s>>1;z(t,e,i,n,s,o),U(t,e,r,n,i-1,1-o),U(t,e,r,i+1,s,1-o)}function z(t,e,r,n,s,o){for(;s>n;){if(s-n>600){const i=s-n+1,a=r-n+1,c=Math.log(i),l=.5*Math.exp(2*c/3),u=.5*Math.sqrt(c*l*(i-l)/i)*(a-i/2<0?-1:1);z(t,e,r,Math.max(n,Math.floor(r-a*l/i+u)),Math.min(s,Math.floor(r+(i-a)*l/i+u)),o)}const i=e[2*r+o];let a=n,c=s;for($(t,e,n,r),e[2*s+o]>i&&$(t,e,n,s);a<c;){for($(t,e,a,c),a++,c--;e[2*a+o]<i;)a++;for(;e[2*c+o]>i;)c--}e[2*n+o]===i?$(t,e,n,c):(c++,$(t,e,c,s)),c<=r&&(n=c+1),r<=c&&(s=c-1)}}function $(t,e,r,n){Z(t,r,n),Z(e,2*r,2*n),Z(e,2*r+1,2*n+1)}function Z(t,e,r){const n=t[e];t[e]=t[r],t[r]=n}function N(t,e,r,n){const s=t-r,o=e-n;return s*s+o*o}const F={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:t=>t},B=Math.fround||(D=new Float32Array(1),t=>(D[0]=+t,D[0]));var D;class R{constructor(t){this.options=Object.assign(Object.create(F),t),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(t){const{log:e,minZoom:r,maxZoom:n}=this.options;t.length;this.points=t;const s=[];for(let e=0;e<t.length;e++){const r=t[e];if(!r.geometry)continue;const[n,o]=r.geometry.coordinates,i=B(H(n)),a=B(V(o));s.push(i,a,1/0,e,-1,1),this.options.reduce&&s.push(0)}let o=this.trees[n+1]=this._createTree(s);for(let t=n;t>=r;t--){Date.now();o=this.trees[t]=this._createTree(this._cluster(o,t))}return this}getClusters(t,e){let r=((t[0]+180)%360+360)%360-180;const n=Math.max(-90,Math.min(90,t[1]));let s=180===t[2]?180:((t[2]+180)%360+360)%360-180;const o=Math.max(-90,Math.min(90,t[3]));if(t[2]-t[0]>=360)r=-180,s=180;else if(r>s){const t=this.getClusters([r,n,180,o],e),i=this.getClusters([-180,n,s,o],e);return t.concat(i)}const i=this.trees[this._limitZoom(e)],a=i.range(H(r),V(o),H(s),V(n)),c=i.data,l=[];for(const t of a){const e=this.stride*t;l.push(c[e+5]>1?G(c,e,this.clusterProps):this.points[c[e+3]])}return l}getChildren(t){const e=this._getOriginId(t),r=this._getOriginZoom(t),n="No cluster with the specified id.",s=this.trees[r];if(!s)throw new Error(n);const o=s.data;if(e*this.stride>=o.length)throw new Error(n);const i=this.options.radius/(this.options.extent*Math.pow(2,r-1)),a=o[e*this.stride],c=o[e*this.stride+1],l=s.within(a,c,i),u=[];for(const e of l){const r=e*this.stride;o[r+4]===t&&u.push(o[r+5]>1?G(o,r,this.clusterProps):this.points[o[r+3]])}if(0===u.length)throw new Error(n);return u}getLeaves(t,e,r){e=e||10,r=r||0;const n=[];return this._appendLeaves(n,t,e,r,0),n}getTile(t,e,r){const n=this.trees[this._limitZoom(t)],s=Math.pow(2,t),{extent:o,radius:i}=this.options,a=i/o,c=(r-a)/s,l=(r+1+a)/s,u={features:[]};return this._addTileFeatures(n.range((e-a)/s,c,(e+1+a)/s,l),n.data,e,r,s,u),0===e&&this._addTileFeatures(n.range(1-a/s,c,1,l),n.data,s,r,s,u),e===s-1&&this._addTileFeatures(n.range(0,c,a/s,l),n.data,-1,r,s,u),u.features.length?u:null}getClusterExpansionZoom(t){let e=this._getOriginZoom(t)-1;for(;e<=this.options.maxZoom;){const r=this.getChildren(t);if(e++,1!==r.length)break;t=r[0].properties.cluster_id}return e}_appendLeaves(t,e,r,n,s){const o=this.getChildren(e);for(const e of o){const o=e.properties;if(o&&o.cluster?s+o.point_count<=n?s+=o.point_count:s=this._appendLeaves(t,o.cluster_id,r,n,s):s<n?s++:t.push(e),t.length===r)break}return s}_createTree(t){const e=new P(t.length/this.stride|0,this.options.nodeSize,Float32Array);for(let r=0;r<t.length;r+=this.stride)e.add(t[r],t[r+1]);return e.finish(),e.data=t,e}_addTileFeatures(t,e,r,n,s,o){for(const i of t){const t=i*this.stride,a=e[t+5]>1;let c,l,u;if(a)c=K(e,t,this.clusterProps),l=e[t],u=e[t+1];else{const r=this.points[e[t+3]];c=r.properties;const[n,s]=r.geometry.coordinates;l=H(n),u=V(s)}const h={type:1,geometry:[[Math.round(this.options.extent*(l*s-r)),Math.round(this.options.extent*(u*s-n))]],tags:c};let p;p=a||this.options.generateId?e[t+3]:this.points[e[t+3]].id,void 0!==p&&(h.id=p),o.features.push(h)}}_limitZoom(t){return Math.max(this.options.minZoom,Math.min(Math.floor(+t),this.options.maxZoom+1))}_cluster(t,e){const{radius:r,extent:n,reduce:s,minPoints:o}=this.options,i=r/(n*Math.pow(2,e)),a=t.data,c=[],l=this.stride;for(let r=0;r<a.length;r+=l){if(a[r+2]<=e)continue;a[r+2]=e;const n=a[r],u=a[r+1],h=t.within(a[r],a[r+1],i),p=a[r+5];let d=p;for(const t of h){const r=t*l;a[r+2]>e&&(d+=a[r+5])}if(d>p&&d>=o){let t,o=n*p,i=u*p,f=-1;const m=(r/l<<5)+(e+1)+this.points.length;for(const n of h){const c=n*l;if(a[c+2]<=e)continue;a[c+2]=e;const u=a[c+5];o+=a[c]*u,i+=a[c+1]*u,a[c+4]=m,s&&(t||(t=this._map(a,r,!0),f=this.clusterProps.length,this.clusterProps.push(t)),s(t,this._map(a,c)))}a[r+4]=m,c.push(o/d,i/d,1/0,m,-1,d),s&&c.push(f)}else{for(let t=0;t<l;t++)c.push(a[r+t]);if(d>1)for(const t of h){const r=t*l;if(!(a[r+2]<=e)){a[r+2]=e;for(let t=0;t<l;t++)c.push(a[r+t])}}}}return c}_getOriginId(t){return t-this.points.length>>5}_getOriginZoom(t){return(t-this.points.length)%32}_map(t,e,r){if(t[e+5]>1){const n=this.clusterProps[t[e+6]];return r?Object.assign({},n):n}const n=this.points[t[e+3]].properties,s=this.options.map(n);return r&&s===n?Object.assign({},s):s}}function G(t,e,r){return{type:"Feature",id:t[e+3],properties:K(t,e,r),geometry:{type:"Point",coordinates:[(n=t[e],360*(n-.5)),W(t[e+1])]}};var n}function K(t,e,r){const n=t[e+5],s=n>=1e4?`${Math.round(n/1e3)}k`:n>=1e3?Math.round(n/100)/10+"k":n,o=t[e+6],i=-1===o?{}:Object.assign({},r[o]);return Object.assign(i,{cluster:!0,cluster_id:t[e+3],point_count:n,point_count_abbreviated:s})}function H(t){return t/360+.5}function V(t){const e=Math.sin(t*Math.PI/180),r=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return r<0?0:r>1?1:r}function W(t){const e=(180-360*t)*Math.PI/180;return 360*Math.atan(Math.exp(e))/Math.PI-90}"function"==typeof SuppressedError&&SuppressedError;class Y{static isAdvancedMarkerAvailable(t){return google.maps.marker&&!0===t.getMapCapabilities().isAdvancedMarkersAvailable}static isAdvancedMarker(t){return google.maps.marker&&t instanceof google.maps.marker.AdvancedMarkerElement}static setMap(t,e){this.isAdvancedMarker(t)?t.map=e:t.setMap(e)}static getPosition(t){if(this.isAdvancedMarker(t)){if(t.position){if(t.position instanceof google.maps.LatLng)return t.position;if(Number.isFinite(t.position.lat)&&Number.isFinite(t.position.lng))return new google.maps.LatLng(t.position.lat,t.position.lng)}return new google.maps.LatLng(null)}return t.getPosition()}static getVisible(t){return!!this.isAdvancedMarker(t)||t.getVisible()}}class J{constructor({markers:t,position:e}){this.markers=[],t&&(this.markers=t),e&&(e instanceof google.maps.LatLng?this._position=e:this._position=new google.maps.LatLng(e))}get bounds(){if(0===this.markers.length&&!this._position)return;const t=new google.maps.LatLngBounds(this._position,this._position);for(const e of this.markers)t.extend(Y.getPosition(e));return t}get position(){return this._position||this.bounds.getCenter()}get count(){return this.markers.filter(t=>Y.getVisible(t)).length}push(t){this.markers.push(t)}delete(){this.marker&&(Y.setMap(this.marker,null),this.marker=void 0),this.markers.length=0}}function X(t,e="assertion failed"){if(null==t)throw Error(e)}class Q{constructor({maxZoom:t=16}){this.maxZoom=t}noop({markers:t}){return tt(t)}}const tt=t=>t.map(t=>new J({position:Y.getPosition(t),markers:[t]}));class et extends Q{constructor(t){var{maxZoom:e,radius:r=60}=t,n=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(r[n[s]]=t[n[s]])}return r}(t,["maxZoom","radius"]);super({maxZoom:e}),this.markers=[],this.clusters=[],this.state={zoom:-1},this.superCluster=new R(Object.assign({maxZoom:this.maxZoom,radius:r},n))}calculate(t){let e=!1,r=t.map.getZoom();X(r),r=Math.round(r);const n={zoom:r};if(!S(t.markers,this.markers)){e=!0,this.markers=[...t.markers];const r=this.markers.map(t=>{const e=Y.getPosition(t);return{type:"Feature",geometry:{type:"Point",coordinates:[e.lng(),e.lat()]},properties:{marker:t}}});this.superCluster.load(r)}return e||(this.state.zoom<=this.maxZoom||n.zoom<=this.maxZoom)&&(e=!S(this.state,n)),this.state=n,0===t.markers.length?(this.clusters=[],{clusters:this.clusters,changed:e}):(e&&(this.clusters=this.cluster(t)),{clusters:this.clusters,changed:e})}cluster({map:t}){const e=t.getZoom();return X(e),this.superCluster.getClusters([-180,-90,180,90],Math.round(e)).map(t=>this.transformCluster(t))}transformCluster({geometry:{coordinates:[t,e]},properties:r}){if(r.cluster)return new J({markers:this.superCluster.getLeaves(r.cluster_id,1/0).map(t=>t.properties.marker),position:{lat:e,lng:t}});const n=r.marker;return new J({markers:[n],position:Y.getPosition(n)})}}class rt{constructor(t,e){this.markers={sum:t.length};const r=e.map(t=>t.count),n=r.reduce((t,e)=>t+e,0);this.clusters={count:e.length,markers:{mean:n/e.length,sum:n,min:Math.min(...r),max:Math.max(...r)}}}}class nt{render({count:t,position:e},r,n){const s=`<svg fill="${t>Math.max(10,r.clusters.markers.mean)?"#ff0000":"#0000ff"}" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 240 240" width="50" height="50">\n<circle cx="120" cy="120" opacity=".6" r="70" />\n<circle cx="120" cy="120" opacity=".3" r="90" />\n<circle cx="120" cy="120" opacity=".2" r="110" />\n<text x="50%" y="50%" style="fill:#fff" text-anchor="middle" font-size="50" dominant-baseline="middle" font-family="roboto,arial,sans-serif">${t}</text>\n</svg>`,o=`Cluster of ${t} markers`,i=Number(google.maps.Marker.MAX_ZINDEX)+t;if(Y.isAdvancedMarkerAvailable(n)){const t=(new DOMParser).parseFromString(s,"image/svg+xml").documentElement;t.setAttribute("transform","translate(0 25)");const r={map:n,position:e,zIndex:i,title:o,content:t};return new google.maps.marker.AdvancedMarkerElement(r)}const a={position:e,zIndex:i,title:o,icon:{url:`data:image/svg+xml;base64,${btoa(s)}`,anchor:new google.maps.Point(25,25)}};return new google.maps.Marker(a)}}class st{constructor(){!function(t,e){for(let r in e.prototype)t.prototype[r]=e.prototype[r]}(st,google.maps.OverlayView)}}var ot;!function(t){t.CLUSTERING_BEGIN="clusteringbegin",t.CLUSTERING_END="clusteringend",t.CLUSTER_CLICK="click",t.GMP_CLICK="gmp-click"}(ot||(ot={}));const it=(t,e,r)=>{e.bounds&&r.fitBounds(e.bounds)};class at extends st{constructor({map:t,markers:e=[],algorithmOptions:r={},algorithm:n=new et(r),renderer:s=new nt,onClusterClick:o=it}){super(),this.map=null,this.idleListener=null,this.markers=[...e],this.clusters=[],this.algorithm=n,this.renderer=s,this.onClusterClick=o,t&&this.setMap(t)}addMarker(t,e){this.markers.includes(t)||(this.markers.push(t),e||this.render())}addMarkers(t,e){t.forEach(t=>{this.addMarker(t,!0)}),e||this.render()}removeMarker(t,e){const r=this.markers.indexOf(t);return-1!==r&&(Y.setMap(t,null),this.markers.splice(r,1),e||this.render(),!0)}removeMarkers(t,e){let r=!1;return t.forEach(t=>{r=this.removeMarker(t,!0)||r}),r&&!e&&this.render(),r}clearMarkers(t){this.markers.length=0,t||this.render()}render(){const t=this.getMap();if(t instanceof google.maps.Map&&t.getProjection()){google.maps.event.trigger(this,ot.CLUSTERING_BEGIN,this);const{clusters:e,changed:r}=this.algorithm.calculate({markers:this.markers,map:t,mapCanvasProjection:this.getProjection()});if(r||null==r){const t=new Set;for(const r of e)1==r.markers.length&&t.add(r.markers[0]);const r=[];for(const e of this.clusters)null!=e.marker&&(1==e.markers.length?t.has(e.marker)||Y.setMap(e.marker,null):r.push(e.marker));this.clusters=e,this.renderClusters(),requestAnimationFrame(()=>r.forEach(t=>Y.setMap(t,null)))}google.maps.event.trigger(this,ot.CLUSTERING_END,this)}}onAdd(){const t=this.getMap();X(t),this.idleListener=t.addListener("idle",this.render.bind(this)),this.render()}onRemove(){this.idleListener&&google.maps.event.removeListener(this.idleListener),this.reset()}reset(){this.markers.forEach(t=>Y.setMap(t,null)),this.clusters.forEach(t=>t.delete()),this.clusters=[]}renderClusters(){const t=new rt(this.markers,this.clusters),e=this.getMap();this.clusters.forEach(r=>{if(1===r.markers.length)r.marker=r.markers[0];else if(r.marker=this.renderer.render(r,t,e),r.markers.forEach(t=>Y.setMap(t,null)),this.onClusterClick){const t=Y.isAdvancedMarker(r.marker)?ot.GMP_CLICK:ot.CLUSTER_CLICK;r.marker.addListener(t,t=>{google.maps.event.trigger(this,ot.CLUSTER_CLICK,r),this.onClusterClick(t,r,e)})}Y.setMap(r.marker,e)})}}const ct={API_URL:"https://hcp.go2.org/wp-json/go2/v1/facilities?year=2025,2026&per_page=500",GOOGLE_MAPS_API_KEY:"AIzaSyDzjnzJImLe2q2uc8ziZYmQVPrI9TDukww",DEFAULT_CENTER:{lat:37.5,lng:-95.7},DEFAULT_ZOOM:4,CLICK_ZOOM:14,CLUSTER_RADIUS:60},lt={screening:{label:"Screening Center",color:"#BBCB32"},cancer_care:{label:"Cancer Care Center",color:"#835A91"},ipn:{label:"IPN Center",color:"#7AD1E5"},biomarker:{label:"Biomarker Center",color:"#2c3495"}};function ut(t){return"data:image/svg+xml;charset=UTF-8,"+encodeURIComponent(`<svg xmlns="http://www.w3.org/2000/svg" width="32" height="44" viewBox="0 0 32 44">\n    <path d="M16 0C7.16 0 0 7.16 0 16c0 12 16 28 16 28s16-16 16-28C32 7.16 24.84 0 16 0z" fill="${t}"/>\n    <circle cx="16" cy="16" r="7" fill="#fff"/>\n  </svg>`)}class ht{render({count:t,position:e}){const r=String(t).length,n=r>2?48:2===r?40:36,s={url:"data:image/svg+xml;charset=UTF-8,"+encodeURIComponent(`<svg xmlns="http://www.w3.org/2000/svg" width="${n}" height="${n}" viewBox="0 0 ${n} ${n}">\n      <circle cx="${n/2}" cy="${n/2}" r="${n/2-2}" fill="#ffffff" stroke="#2c3495" stroke-width="3"/>\n      <text x="${n/2}" y="${n/2}" text-anchor="middle" dominant-baseline="central" fill="#2c3495" font-family="Arial,Helvetica,sans-serif" font-weight="800" font-size="14">${t}</text>\n    </svg>`),scaledSize:new google.maps.Size(n,n),anchor:new google.maps.Point(n/2,n/2)};return new google.maps.Marker({position:e,icon:s,zIndex:1e3+t})}}async function pt(t){const e=t.querySelector("[data-centers='list']"),n=t.querySelector("[data-centers='map']"),s=t.querySelector("[data-custom='centers-zip-field']"),o=t.querySelector("[data-centers='categories-select']"),i=document.querySelector('[data-centers="list-item"]').cloneNode(!0);o.innerHTML="";const a=document.createElement("option");a.value="all",a.textContent="All",o.appendChild(a);for(const[t,{label:e}]of Object.entries(lt)){const r=document.createElement("option");r.value=t,r.textContent=e,o.appendChild(r)}e.innerHTML='<p style="padding:1rem;color:#666;">Loading centers...</p>';try{r({key:ct.GOOGLE_MAPS_API_KEY,v:"weekly"}),await async function(t){if(!window?.google?.maps?.importLibrary)throw new Error("google.maps.importLibrary is not installed.");return await google.maps.importLibrary(t)}("maps")}catch(t){return void(n.innerHTML='<p style="padding:1rem;color:red;">Failed to load Google Maps. Please try again later.</p>')}const c=new google.maps.Map(n,{center:ct.DEFAULT_CENTER,zoom:ct.DEFAULT_ZOOM}),l={};for(const[t,{color:e}]of Object.entries(lt))l[t]={url:ut(e),scaledSize:new google.maps.Size(32,44),anchor:new google.maps.Point(16,44)};const u=new google.maps.InfoWindow;let h=[];try{const t=await fetch(ct.API_URL);if(!t.ok)throw new Error(`HTTP ${t.status}`);const e=await t.json();if(h=e.facilities||[],e.total_pages>1){const t=[];for(let r=2;r<=e.total_pages;r++)t.push(fetch(`${ct.API_URL}&page=${r}`).then(t=>t.ok?t.json():Promise.reject(t.status)).then(t=>t.facilities||[]));const r=await Promise.all(t);for(const t of r)h=h.concat(t)}}catch(t){return void(e.innerHTML='<p style="padding:1rem;color:red;">Failed to load centers. Please try again later.</p>')}const p=function(t){const e=[];for(const r of t){if(!r.designations||!r.designations.length)continue;const t=new Map;for(const e of r.designations){const n=e.type;if(!lt[n])continue;let s,o,i,a,c;if(e.overrides&&e.overrides.address&&null!=e.overrides.address.latitude&&null!=e.overrides.address.longitude){const t=e.overrides.address;s=parseFloat(t.latitude),o=parseFloat(t.longitude),i=[t.line1,t.line2,t.city,t.state,t.zip].filter(Boolean).join(", "),a=e.overrides.phone||r.phone,c=e.overrides.url||r.website}else{s=parseFloat(r.latitude),o=parseFloat(r.longitude);const t=r.address||{};i=[t.line1,t.line2,t.city,t.state,t.zip].filter(Boolean).join(", "),a=r.phone,c=r.website}if(isNaN(s)||isNaN(o))continue;const l=`${s},${o}`;t.has(l)||t.set(l,{lat:s,lng:o,address:i,phone:a,website:c,designationTypes:[]}),t.get(l).designationTypes.push(n)}for(const[,n]of t){const t=r.address||{};e.push({fid:r.fid,name:r.name,lat:n.lat,lng:n.lng,address:n.address,phone:n.phone,website:n.website,imageUrl:r.image_url,designationTypes:n.designationTypes,primaryType:n.designationTypes[0],zip:t.zip||"",city:t.city||"",state:t.state||""})}}return e}(h);let d=[],f=null;function m(t){if(e.innerHTML="",f&&(f.clearMarkers(),f=null),d.forEach(t=>t.setMap(null)),d=[],0===t.length)return void(e.innerHTML='<p style="padding:1rem;color:#666;">No centers match your search.</p>');const r=new google.maps.LatLngBounds;t.forEach(t=>{const n=i.cloneNode(!0);n.dataset.id=t.fid;const s=n.querySelector('[data-center="icon"]');s&&(l[t.primaryType]?(s.src=l[t.primaryType].url,s.alt=lt[t.primaryType]?.label||t.primaryType):s.parentElement?.remove());const o=n.querySelector('[data-custom="center-name"]');o&&(o.textContent=t.name);const a=n.querySelector('[data-custom="center-city"]');a&&(a.textContent=t.city);const u=n.querySelector('[data-custom="center-zip-code"]');u&&(u.textContent=t.zip);const h=n.querySelector('[data-centers="where"]');h&&(t.website?(h.href=t.website,h.textContent=t.website):h.parentElement?.remove());const p=n.querySelector('[data-custom="center-accreditations"]');if(p){const e=t.designationTypes.map(t=>lt[t]?.label||t).join(", ");p.textContent=e}n.addEventListener("click",()=>{c.setCenter({lat:t.lat,lng:t.lng}),c.setZoom(ct.CLICK_ZOOM);const e=d.find(e=>e.getPosition().lat()===t.lat&&e.getPosition().lng()===t.lng);e&&g(e,t)}),e.appendChild(n);const f={lat:t.lat,lng:t.lng},m=new google.maps.Marker({position:f,icon:l[t.primaryType]||void 0,map:null});m.addListener("click",()=>g(m,t)),d.push(m),r.extend(f)}),f=new at({map:c,markers:d,renderer:new ht,algorithm:new et({radius:ct.CLUSTER_RADIUS})}),d.length>1?c.fitBounds(r):1===d.length&&(c.setCenter(d[0].getPosition()),c.setZoom(ct.CLICK_ZOOM))}function g(t,e){const r=e.designationTypes.map(t=>{const e=lt[t];return e?`<span style="display:inline-block;padding:2px 8px;border-radius:3px;background:${e.color};color:#fff;font-size:12px;margin:2px 2px 2px 0;">${e.label}</span>`:""}).join(""),n=`\n      <div style="max-width:240px;font-family:Arial,sans-serif;">\n        <strong style="font-size:14px;">${e.name}</strong>\n        <div style="margin:6px 0;">${r}</div>\n        <div style="font-size:13px;color:#444;margin-bottom:6px;">${e.address}</div>\n        ${e.imageUrl?`<img src="${e.imageUrl}" alt="${e.name}" style="width:100%;border-radius:4px;margin-bottom:6px;" />`:""}\n        ${e.phone?`<div><a href="tel:${e.phone}" style="font-size:13px;">${e.phone}</a></div>`:""}\n        <div style="margin-top:4px;">\n          <a href="https://www.google.com/maps/dir/?api=1&destination=${e.lat},${e.lng}&travelmode=driving" target="_blank" rel="noopener" style="font-size:13px;">Get Directions</a>\n        </div>\n      </div>\n    `;u.setContent(n),u.open(c,t)}function y(){const t=s.value.trim(),e=o.value;let r=p;t&&(r=r.filter(e=>String(e.zip).startsWith(t))),e&&"all"!==e&&(r=r.filter(t=>t.designationTypes.includes(e))),m(r)}m(p),s.addEventListener("input",y),o.addEventListener("change",y),document.querySelector('[data-centers="list-item"]')?.remove()}export{pt as default};
