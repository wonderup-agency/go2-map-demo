import{h as e,s as t,v as r,c as o,a,b as i,f as n,r as s,d as l,e as d}from"./index-PUb_Pgg4.js";import"./main-DQLxFuuE.js";function f(f){(f.forEach?f:[f]).forEach(f=>{const c=f.dataset.webhook||"https://hook.us2.make.com/x3fm8t3nor5poc4ij7purslvicjo9sxr",m=Array.from(f.querySelectorAll('[data-form="step"]')),p=f.querySelector('[data-helpline-form="ticket-id-field"]'),h=f.querySelector(".w-form-done"),u=f.querySelector(".w-form-fail"),y=f.querySelector("form");p&&(p.disabled=!0,p.type="hidden"),m.forEach((e,t)=>{0!==t&&e.classList.add("hide")}),f.addEventListener("click",async f=>{const b=f.target,x=b.closest('[data-form="next-btn"]'),E=b.closest('[data-form="submit-btn"]'),S=b.closest(".button_text");if(x||S&&x){e(u);const l=x.closest('[data-form="step"]');if(!l)return;const d=Array.from(y?.children||[]).indexOf(l);if(-1===d)return;const f=await t(l),h=[];if(0===d){r.isEmpty(f["HelpLine-Name"]||"")&&h.push({fieldName:"HelpLine-Name",error:"Enter your full name",appendAt:".multi-form14_field-wrapper"}),r.isEmail(f["HelpLine-Email"]||"")||h.push({fieldName:"HelpLine-Email",error:"Enter a valid email address (example: name@email.com)",appendAt:".multi-form14_field-wrapper"});const e=f["HelpLine-Phone"]||"";r.isMobilePhone(e,"any")||h.push({fieldName:"HelpLine-Phone",error:"Enter a valid phone number (include area code)",appendAt:".multi-form14_field-wrapper"})}if(o(),h.length>0)return void a(h,l);const b=x.querySelector(".button_text")||x.firstChild,E=b?.textContent||"Next";i(x),fetch(c,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(f)}).then(e=>{if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);return e.json()}).then(e=>{p&&(p.value=e?.ticket||e||""),l.classList.add("hide");const t=d+1;t<m.length&&m[t].classList.remove("hide")}).catch(e=>{n(u)}).finally(()=>{s(x,E)})}if(E||S&&E){f.preventDefault(),f.stopImmediatePropagation(),e(u);const r=E.closest('[data-form="step"]');if(!r)return;if(-1===Array.from(y?.children||[]).indexOf(r))return;const m=await t(r),b=[];if(o(),b.length>0)return void a(b,r);const x=E.querySelector(".button_text")||E.firstChild,S=x?.textContent||"Submit";i(E),m["ticket-id"]=p.value,fetch(c,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(m)}).then(e=>{if(!e.ok)throw new Error("Submission failed");return e.json()}).then(e=>{l(y),d(h)}).catch(e=>{n(u)}).finally(()=>{s(E,S)})}})})}export{f as default};
