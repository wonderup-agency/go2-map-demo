{"version":3,"file":"mind-over-matter-ClS-nbdR.js","sources":["../src/components/forms/mind-over-matter.js"],"sourcesContent":["import {\n  serializeInputs,\n  clearStepsErrors,\n  appendStepsErrors,\n  setButtonLoading,\n  resetButton,\n  hideFail,\n  showFail,\n  showSuccess,\n  hideForm,\n  setupOtherFieldForCheckbox,\n  setupOtherFieldForSelect,\n} from '../../utils/functions'\n\nimport validator from 'validator'\n\n/**\n * Handles form submission for a multi-step form component.\n * @param {HTMLElement} component - The form component containing steps and inputs.\n */\nexport default function (component) {\n  const formInstances = component.forEach ? component : [component]\n\n  formInstances.forEach((formInstance) => {\n    const webhookAddress = formInstance.dataset.webhook || 'https://hook.us2.make.com/ax5pllsfmf5zl2lwfprq5og2locrkmyi'\n\n    const successEl = formInstance.querySelector('.w-form-done')\n    const failEl = formInstance.querySelector('.w-form-fail')\n    const formEl = formInstance.querySelector('form')\n\n    setupOtherFieldForSelect({\n      context: formInstance,\n      selectId: 'connection-to-lung-cancer',\n      otherValue: 'other-connection',\n      fieldName: 'other-connection-to-cancer',\n      labelName: 'Specify other connection',\n      placeholder: 'Specify your connection to lung cancer',\n      wrapperClass: 'multi-form14_field-wrapper',\n    })\n    setupOtherFieldForSelect({\n      context: formInstance,\n      selectId: 'hear-about-mom',\n      otherValue: 'other-way',\n      fieldName: 'hear-about-mom-other',\n      labelName: 'How did you hear about GO2',\n      placeholder: 'Specify how did you hear about GO2',\n      wrapperClass: 'multi-form14_field-wrapper',\n    })\n\n    formInstance.addEventListener('click', (e) => {\n      const target = e.target\n      const submitBtn = target.closest('[data-form=\"submit-btn\"]')\n      const buttonText = target.closest('.button_text')\n\n      // SUBMIT BUTTON HANDLER\n      if (submitBtn || (buttonText && submitBtn)) {\n        e.preventDefault()\n        e.stopImmediatePropagation()\n\n        // Hide fail element on button press (validations will rerun)\n        hideFail(failEl)\n\n        const submitInputsData = serializeInputs(formEl)\n\n        // Log serialized data for debugging\n        console.log('Submit button - Serialized submit data:', submitInputsData)\n\n        const errors = []\n\n        // Submit step validations\n        if (validator.isEmpty(submitInputsData['full-name'] || '')) {\n          errors.push({\n            fieldName: 'full-name',\n            error: 'Enter your full name.',\n            appendAt: '.multi-form14_field-wrapper',\n          })\n        }\n        if (!validator.isEmail(submitInputsData['email'] || '')) {\n          errors.push({\n            fieldName: 'email',\n            error: 'Enter a valid email address (example: name@email.com)',\n            appendAt: '.multi-form14_field-wrapper',\n          })\n        }\n        const phone = submitInputsData['phone'] || ''\n        if (!validator.isMobilePhone(phone, 'any')) {\n          errors.push({\n            fieldName: 'phone',\n            error: 'Enter a valid phone number (digits only, include area code)',\n            appendAt: '.multi-form14_field-wrapper',\n          })\n        }\n        if (!validator.isPostalCode(String(submitInputsData?.['zip-code'] || ''), 'any')) {\n          errors.push({\n            fieldName: 'zip-code',\n            error: 'Enter a valid ZIP or postal code',\n            appendAt: '.multi-form14_field-wrapper',\n          })\n        }\n        if (\n          'other-connection-to-cancer' in submitInputsData &&\n          validator.isEmpty(submitInputsData['other-connection-to-cancer'] || '')\n        ) {\n          errors.push({\n            fieldName: 'other-connection-to-cancer',\n            error: 'Tell us your connection to lung cancer',\n            appendAt: '.multi-form14_field-wrapper',\n          })\n        }\n        if (\n          'hear-about-mom-other' in submitInputsData &&\n          validator.isEmpty(submitInputsData['hear-about-mom-other'] || '')\n        ) {\n          errors.push({\n            fieldName: 'hear-about-mom-other',\n            error: 'Tell us how you heard about GO2',\n            appendAt: '.multi-form14_field-wrapper',\n          })\n        }\n\n        // Clear any existing errors\n        clearStepsErrors(formEl)\n\n        // If there are errors, append them and stop\n        if (errors.length > 0) {\n          appendStepsErrors(errors)\n          return\n        }\n\n        // Set loading state\n        const submitBtnTextEl = submitBtn.querySelector('.button_text') || submitBtn.firstChild\n        const submitBtnInitialText = submitBtnTextEl?.textContent || 'Submit'\n        setButtonLoading(submitBtn)\n\n        fetch(webhookAddress, {\n          method: 'POST',\n          headers: { 'Content-Type': 'application/json' },\n          body: JSON.stringify(submitInputsData),\n        })\n          .then((response) => {\n            if (!response.ok) throw new Error('Submission failed')\n            return response.json()\n          })\n          .then((data) => {\n            hideForm(formEl)\n            showSuccess(successEl)\n          })\n          .catch((error) => {\n            console.error('Submit fetch error:', error)\n            showFail(failEl)\n          })\n          .finally(() => {\n            resetButton(submitBtn, submitBtnInitialText)\n          })\n      }\n    })\n  })\n}\n"],"names":["mindOverMatter","component","forEach","formInstance","webhookAddress","dataset","webhook","successEl","querySelector","failEl","formEl","setupOtherFieldForSelect","context","selectId","otherValue","fieldName","labelName","placeholder","addEventListener","e","target","submitBtn","closest","buttonText","preventDefault","stopImmediatePropagation","hideFail","submitInputsData","serializeInputs","errors","validator","isEmpty","push","error","appendAt","isEmail","phone","isMobilePhone","isPostalCode","String","clearStepsErrors","length","appendStepsErrors","submitBtnTextEl","firstChild","submitBtnInitialText","textContent","setButtonLoading","fetch","method","headers","body","JSON","stringify","then","response","ok","Error","json","data","hideForm","showSuccess","catch","showFail","finally","resetButton"],"mappings":"yIAoBe,SAAAA,EAAUC,IACDA,EAAUC,QAAUD,EAAY,CAACA,IAEzCC,QAASC,IACrB,MAAMC,EAAiBD,EAAaE,QAAQC,SAAW,6DAEjDC,EAAYJ,EAAaK,cAAc,gBACvCC,EAASN,EAAaK,cAAc,gBACpCE,EAASP,EAAaK,cAAc,QAE1CG,EAAyB,CACvBC,QAAST,EACTU,SAAU,4BACVC,WAAY,mBACZC,UAAW,6BACXC,UAAW,2BACXC,YAAa,2CAGfN,EAAyB,CACvBC,QAAST,EACTU,SAAU,iBACVC,WAAY,YACZC,UAAW,uBACXC,UAAW,6BACXC,YAAa,uCAIfd,EAAae,iBAAiB,QAAUC,IACtC,MAAMC,EAASD,EAAEC,OACXC,EAAYD,EAAOE,QAAQ,4BAC3BC,EAAaH,EAAOE,QAAQ,gBAGlC,GAAID,GAAcE,GAAcF,EAAY,CAC1CF,EAAEK,iBACFL,EAAEM,2BAGFC,EAASjB,GAET,MAAMkB,EAAmBC,EAAgBlB,GAKnCmB,EAAS,GAGXC,EAAUC,QAAQJ,EAAiB,cAAgB,KACrDE,EAAOG,KAAK,CACVjB,UAAW,YACXkB,MAAO,wBACPC,SAAU,gCAGTJ,EAAUK,QAAQR,EAAwB,OAAK,KAClDE,EAAOG,KAAK,CACVjB,UAAW,QACXkB,MAAO,wDACPC,SAAU,gCAGd,MAAME,EAAQT,EAAwB,OAAK,GAwC3C,GAvCKG,EAAUO,cAAcD,EAAO,QAClCP,EAAOG,KAAK,CACVjB,UAAW,QACXkB,MAAO,8DACPC,SAAU,gCAGTJ,EAAUQ,aAAaC,OAAOZ,IAAmB,aAAe,IAAK,QACxEE,EAAOG,KAAK,CACVjB,UAAW,WACXkB,MAAO,mCACPC,SAAU,gCAIZ,+BAAgCP,GAChCG,EAAUC,QAAQJ,EAAiB,+BAAiC,KAEpEE,EAAOG,KAAK,CACVjB,UAAW,6BACXkB,MAAO,yCACPC,SAAU,gCAIZ,yBAA0BP,GAC1BG,EAAUC,QAAQJ,EAAiB,yBAA2B,KAE9DE,EAAOG,KAAK,CACVjB,UAAW,uBACXkB,MAAO,kCACPC,SAAU,gCAKdM,IAGIX,EAAOY,OAAS,EAElB,YADAC,EAAkBb,GAKpB,MAAMc,EAAkBtB,EAAUb,cAAc,iBAAmBa,EAAUuB,WACvEC,EAAuBF,GAAiBG,aAAe,SAC7DC,EAAiB1B,GAEjB2B,MAAM5C,EAAgB,CACpB6C,OAAQ,OACRC,QAAS,CAAE,eAAgB,oBAC3BC,KAAMC,KAAKC,UAAU1B,KAEpB2B,KAAMC,IACL,IAAKA,EAASC,GAAI,MAAM,IAAIC,MAAM,qBAClC,OAAOF,EAASG,SAEjBJ,KAAMK,IACLC,EAASlD,GACTmD,EAAYtD,KAEbuD,MAAO7B,IAEN8B,EAAStD,KAEVuD,QAAQ,KACPC,EAAY5C,EAAWwB,IAE7B,KAGN"}